# Формальный анализ иерархии вероятностных состояний: операции, соответствия и вычислительная мощность промежуточных уровней

## Аннотация

В данной работе проводится строгий математический анализ иерархии вероятностных состояний, представляющей собой формальный мост между классической булевой логикой и квантовыми вычислениями. Основное внимание уделяется: (1) детальному исследованию обобщенной операции сложения ⊕₄ на уровне фазовых состояний, включая вариативные определения и их оптимальность с точки зрения сохранения алгебраических свойств; (2) разработке формального аппарата для доказательства коммутативных соотношений между операциями на различных уровнях; (3) оценке вычислительной мощности промежуточных моделей; (4) конструированию квазиквантовых алгоритмов, использующих преимущества фазовых состояний. Представлены и доказаны теоремы о предельных возможностях моделей на основе p-битов и фазовых состояний, установлены алгоритмические границы для задач, решаемых в рамках данного формализма.

## 1. Введение

Формальный переход от классической вычислительной парадигмы к квантовой представляет значительный интерес как с теоретической, так и с практической точки зрения. Фундаментальное различие между дискретной булевой логикой классических вычислений и линейно-алгебраической природой квантовых вычислений породило необходимость построения формального моста, описывающего промежуточные уровни вычислительных моделей.

Ранее был предложен унифицированный формализм, выделяющий пять уровней вероятностных состояний, начиная с классических битов и заканчивая полноценными квантовыми состояниями [1]. Особый интерес представляют промежуточные уровни — вероятностные биты (уровень 2), p-биты (уровень 3) и фазовые состояния (уровень 4), которые сохраняют часть квантовых свойств, таких как интерференция, но потенциально допускают более простую физическую реализацию.

В данной работе мы сосредоточимся на следующих открытых вопросах:

1. Оптимальное определение операции ⊕₄ для фазовых состояний с точки зрения сохранения алгебраических свойств и соответствия физической интуиции;
2. Формальное доказательство коммутативных соотношений между операциями на разных уровнях;
3. Теоретические границы вычислительной мощности промежуточных моделей;
4. Применение формализма для конструирования квазиквантовых алгоритмов.

## 2. Обобщенная операция сложения на уровне фазовых состояний

### 2.1. Существующее определение и его свойства

Напомним, что фазовое состояние на 4-м уровне определяется как пара $(p, e^{i\phi})$, где $p \in [0,1]$ представляет вероятностную составляющую, а $e^{i\phi}$ с $\phi \in [0,2\pi)$ — фазовую.

Стандартное определение операции ⊕₄, предложенное в [1], имеет вид:

$(p_1, e^{i\phi_1}) \oplus_4 (p_2, e^{i\phi_2}) = (F(p_1, p_2, \phi_1, \phi_2), e^{iG(p_1, p_2, \phi_1, \phi_2)})$

где
$F(p_1, p_2, \phi_1, \phi_2) = p_1 + p_2 + 2\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2)$

$G(p_1, p_2, \phi_1, \phi_2) = \arg(\sqrt{p_1}e^{i\phi_1} + \sqrt{p_2}e^{i\phi_2})$

**Теорема 2.1.** *Операция ⊕₄, определенная выше, обладает следующими свойствами:*
1. *Коммутативность: $(p_1, e^{i\phi_1}) \oplus_4 (p_2, e^{i\phi_2}) = (p_2, e^{i\phi_2}) \oplus_4 (p_1, e^{i\phi_1})$*
2. *Нейтральный элемент: $(0, e^{i\phi}) \oplus_4 (p, e^{i\theta}) = (p, e^{i\theta})$ для любого φ*
3. *Ограниченность: Если $p_1, p_2 \in [0,1]$, то $0 \leq F(p_1, p_2, \phi_1, \phi_2) \leq 4$* (для сохранения вероятностной интерпретации далее используется нормализация/клиппинг вероятности к [0,1]).

**Доказательство.**
1. Коммутативность следует из симметрии функций $F$ и $G$ относительно перестановки индексов.
2. Для $p_1 = 0$ имеем $F(0, p_2, \phi_1, \phi_2) = 0 + p_2 + 2\sqrt{0 \cdot p_2}\cos(\phi_1 - \phi_2) = p_2$  
   $G(0, p_2, \phi_1, \phi_2) = \arg(0 + \sqrt{p_2}e^{i\phi_2}) = \phi_2$
3. Рассмотрим функцию $F$:
   - Минимальное значение достигается при $\cos(\phi_1 - \phi_2) = -1$, тогда  
     $F(p_1, p_2, \phi_1, \phi_2) = p_1 + p_2 - 2\sqrt{p_1 p_2} = (\sqrt{p_1} - \sqrt{p_2})^2 \geq 0$
   - Максимальное значение достигается при $\cos(\phi_1 - \phi_2) = 1$, тогда  
     $F(p_1, p_2, \phi_1, \phi_2) = p_1 + p_2 + 2\sqrt{p_1 p_2} = (\sqrt{p_1} + \sqrt{p_2})^2 \leq (\sqrt{1} + \sqrt{1})^2 = 4$

**Замечание 2.1.** Функция $F$ может принимать значения больше 1, что противоречит интерпретации $p$ как вероятности. Это создает необходимость нормализации результата для сохранения вероятностной интерпретации.

### 2.2. Альтернативные определения операции ⊕₄

Рассмотрим альтернативные определения операции ⊕₄, которые потенциально могут сохранять более строгую вероятностную интерпретацию и/или дополнительные алгебраические свойства.

**Определение 2.1 (Нормализованное сложение).** 
$(p_1, e^{i\phi_1}) \oplus_4^{norm} (p_2, e^{i\phi_2}) = (F_{norm}(p_1, p_2, \phi_1, \phi_2), e^{iG(p_1, p_2, \phi_1, \phi_2)})$

где
$F_{norm}(p_1, p_2, \phi_1, \phi_2) = \min\{1, F(p_1, p_2, \phi_1, \phi_2)\}$

**Определение 2.2 (Взвешенное сложение).**
$(p_1, e^{i\phi_1}) \oplus_4^{weight} (p_2, e^{i\phi_2}) = (F_{weight}(p_1, p_2, \phi_1, \phi_2), e^{iG(p_1, p_2, \phi_1, \phi_2)})$

где
$F_{weight}(p_1, p_2, \phi_1, \phi_2) = p_1 + p_2 - p_1p_2 + (2\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2))/(1 + \max(p_1, p_2))$

**Определение 2.3 (Квантово-подобное сложение).**
$(p_1, e^{i\phi_1}) \oplus_4^{quant} (p_2, e^{i\phi_2}) = (|\alpha_1 + \alpha_2|^2, \arg(\alpha_1 + \alpha_2))$

где $\alpha_j = \sqrt{p_j}e^{i\phi_j}$ для $j \in \{1,2\}$, что делает операцию максимально близкой к квантовому сложению амплитуд.

---

Практическая заметка (режимы в библиотеке). В реализации библиотеки режим операции $\oplus_4$ выбирается функцией `set_phase_or_mode(mode: str, delta_phi: float = π/2)`:

```python
import numpy as np
from probstates import set_phase_or_mode

# По умолчанию квантово‑подобное сложение амплитуд
set_phase_or_mode('quant')

# Гарантировать вероятности в [0,1] при любых фазах (жёсткий клиппинг)
set_phase_or_mode('norm')

# Смягчённая интерференция: устойчивее к выбросам/несоответствию фаз
set_phase_or_mode('weight')

# Коммутативное соответствие 3↔4 при Δφ = π/2 (см. §2.4)
set_phase_or_mode('opt', delta_phi=np.pi/2)
```

Краткие рекомендации по выбору режима:
- quant: когда важна «максимальная» интерференция (модель ближе к квантовой), допустим временный выход F>1 на промежуточных шагах.
- norm: когда необходимо строгое сохранение вероятности в [0,1] при любых фазах (безопасное сложение многих слагаемых).
- weight: когда нужен компромисс между интерференцией и устойчивостью (например, робастное слияние источников/сенсоров).
- opt: когда требуется соответствие подъёма/операции между уровнями 3 и 4; используйте Δφ=π/2.

### 2.3. Сравнительный анализ определений (и реализованные режимы)

Проведем формальный анализ предложенных определений с точки зрения сохранения алгебраических свойств. В библиотеке доступны режимы 'quant', 'opt', а также альтернативы 'norm' и 'weight' из §2.2 (см. `set_phase_or_mode`).

**Теорема 2.2.** *Среди предложенных определений операции ⊕₄:*
1. *Все определения сохраняют коммутативность*
2. *Определения 2.1 и 2.3 сохраняют нейтральный элемент $(0, e^{i\phi})$*
3. *Только определение 2.3 (квантово-подобное) сохраняет ассоциативность в случае, когда результирующая вероятность не превышает 1*
4. *Определение 2.1 (norm) гарантирует ограниченность $F\in[0,1]$ при любых $p_1,p_2,\phi_1,\phi_2$*
5. *Определение 2.2 (weight) ослабляет вклад интерференции за счёт деления на $(1+\max(p_1,p_2))$, оставаясь коммутативным и нейтральным*

**Доказательство.**
1. Для всех определений коммутативность следует из симметрии функций относительно перестановки индексов.
2. Для определения 2.1 и 2.3 легко проверить, что при $p_1 = 0$ результат равен $(p_2, e^{i\phi_2})$.
3. Для определения 2.3, запишем
   $((p_1, e^{i\phi_1}) \oplus_4^{quant} (p_2, e^{i\phi_2})) \oplus_4^{quant} (p_3, e^{i\phi_3})$
   
   Пусть $\alpha_j = \sqrt{p_j}e^{i\phi_j}$, тогда
   
   $((p_1, e^{i\phi_1}) \oplus_4^{quant} (p_2, e^{i\phi_2})) = (|\alpha_1 + \alpha_2|^2, \arg(\alpha_1 + \alpha_2))$
   
   Обозначим $\beta = \alpha_1 + \alpha_2$, тогда
   
   $((p_1, e^{i\phi_1}) \oplus_4^{quant} (p_2, e^{i\phi_2})) \oplus_4^{quant} (p_3, e^{i\phi_3}) = (|\beta + \alpha_3|^2, \arg(\beta + \alpha_3)) = (|(\alpha_1 + \alpha_2) + \alpha_3|^2, \arg((\alpha_1 + \alpha_2) + \alpha_3))$
   
   Аналогично для $(p_1, e^{i\phi_1}) \oplus_4^{quant} ((p_2, e^{i\phi_2}) \oplus_4^{quant} (p_3, e^{i\phi_3}))$ получаем
   
   $(|(\alpha_1 + (\alpha_2 + \alpha_3)|^2, \arg(\alpha_1 + (\alpha_2 + \alpha_3)))$
   
   Равенство выполняется в силу ассоциативности операции сложения комплексных чисел.

**Теорема 2.3.** *Определение 2.3 (квантово-подобное) не обеспечивает корректного соответствия между уровнями 3 и 4, т.е. не выполняется соотношение*
$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2)$

**Доказательство.**
Рассмотрим $p_1 = p_2 = 0.6$ и $s_1 = s_2 = +1$.

Тогда $(p_1, s_1) \oplus_3 (p_2, s_2) = (0.6 + 0.6 - 0.6 \cdot 0.6, (+1) \cdot (+1) \cdot \text{sign}(0.6 + 0.6 - 1)) = (0.84, -1)$

$L_{3 \rightarrow 4}(0.84, -1) = (0.84, e^{i\pi})$

С другой стороны,
$L_{3 \rightarrow 4}(p_1, s_1) = (0.6, e^{i \cdot 0}) = (0.6, 1)$
$L_{3 \rightarrow 4}(p_2, s_2) = (0.6, e^{i \cdot 0}) = (0.6, 1)$

Используя определение 2.3:
$L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2) = (|\sqrt{0.6} + \sqrt{0.6}|^2, \arg(\sqrt{0.6} + \sqrt{0.6})) = (2.4, 0)$

Очевидно, что $(0.84, e^{i\pi}) \neq (2.4, 0)$. □

**Доказательство.**
Докажем, что для определения 2.3 (квантово-подобное) коммутативное соотношение между уровнями 3 и 4 нарушается в общем случае.

Для произвольных P-битов $(p_1, s_1)$ и $(p_2, s_2)$ операция $\oplus_3$ определяется как:
$(p_1, s_1) \oplus_3 (p_2, s_2) = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$

Применяя оператор подъема $L_{3 \rightarrow 4}$ к результату, получаем:
$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = L_{3 \rightarrow 4}(p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$

По определению оператора подъема $L_{3 \rightarrow 4}$:
$L_{3 \rightarrow 4}(p, s) = (p, e^{i\phi_s})$, где $\phi_s = 0$ при $s = +1$ и $\phi_s = \pi$ при $s = -1$

Таким образом:
$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = (p_1 + p_2 - p_1 \cdot p_2, e^{i\phi})$,
где $\phi = 0$ если $s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1) = +1$, и $\phi = \pi$ если $s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1) = -1$

С другой стороны, применяя оператор подъема к исходным состояниям:
$L_{3 \rightarrow 4}(p_1, s_1) = (p_1, e^{i\phi_1})$, где $\phi_1 = 0$ при $s_1 = +1$ и $\phi_1 = \pi$ при $s_1 = -1$
$L_{3 \rightarrow 4}(p_2, s_2) = (p_2, e^{i\phi_2})$, где $\phi_2 = 0$ при $s_2 = +1$ и $\phi_2 = \pi$ при $s_2 = -1$

По определению 2.3 операции $\oplus_4^{quant}$ (используемому и по умолчанию в библиотеке):
$L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2) = (|\alpha_1 + \alpha_2|^2, \arg(\alpha_1 + \alpha_2))$,
где $\alpha_j = \sqrt{p_j}e^{i\phi_j}$ для $j \in \{1,2\}$

Вычисляя $|\alpha_1 + \alpha_2|^2$:
$|\alpha_1 + \alpha_2|^2 = |\sqrt{p_1}e^{i\phi_1} + \sqrt{p_2}e^{i\phi_2}|^2 = p_1 + p_2 + 2\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2)$

Когда $s_1 = s_2 = +1$, имеем $\phi_1 = \phi_2 = 0$, следовательно:
$|\alpha_1 + \alpha_2|^2 = p_1 + p_2 + 2\sqrt{p_1 p_2} = (\sqrt{p_1} + \sqrt{p_2})^2$

Однако, если $p_1 + p_2 > 1$, то $s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1) = -1$ и фаза левой части равна $\pi$, тогда как фаза правой части равна $\arg(\sqrt{p_1} + \sqrt{p_2}) = 0$.

Таким образом, для любых $p_1, p_2 > 0$ таких, что $p_1 + p_2 > 1$ и $s_1 = s_2 = +1$, имеем:
$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) \neq L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2)$

Коммутативное соотношение нарушается. □

### 2.4. Оптимальное определение с точки зрения коммутативных соотношений (режим 'opt')

Исходя из результатов предыдущего анализа, предложим определение операции ⊕₄, которое обеспечивает наилучшее соответствие коммутативным соотношениям между уровнями иерархии.

**Определение 2.4 (Оптимальное сложение).**
$(p_1, e^{i\phi_1}) \oplus_4^{opt} (p_2, e^{i\phi_2}) = (F_{opt}(p_1, p_2, \phi_1, \phi_2), e^{iG_{opt}(p_1, p_2, \phi_1, \phi_2)})$

где
$F_{opt}(p_1, p_2, \phi_1, \phi_2) = p_1 \oplus_2 p_2 + K(p_1, p_2)\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2)$

$G_{opt}(p_1, p_2, \phi_1, \phi_2) = 
\begin{cases}
\phi_1, & \text{если } p_2 = 0 \\
\phi_2, & \text{если } p_1 = 0 \\
\phi_{\text{avg}} + \Delta\phi \cdot \text{sign}(p_1 + p_2 - 1), & \text{иначе}
\end{cases}$

где $p_1 \oplus_2 p_2 = p_1 + p_2 - p_1p_2$, $K(p_1, p_2) = 2(1-\max(p_1, p_2))$, $\phi_{\text{avg}} = (\phi_1 + \phi_2)/2$, $\Delta\phi$ — параметр смещения фазы.

**Теорема 2.4.** *Операция ⊕₄^{opt}, определенная в 2.4, обеспечивает выполнение следующих свойств:*
1. *Сохранение ограничения: $F_{opt}(p_1, p_2, \phi_1, \phi_2) \in [0,1]$ для всех $p_1, p_2 \in [0,1]$*
2. *Соответствие между уровнями 3 и 4:*
   $L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{opt} L_{3 \rightarrow 4}(p_2, s_2)$
   *при подходящем выборе параметра $\Delta\phi = \pi/2$*

3. *Коммутативность и наличие нейтрального элемента $(0, e^{i\phi})$*

*Доказательство опущено в силу объемности, но может быть проведено непосредственной проверкой соотношений.*

**Доказательство:**

1. *Сохранение ограничения:* Докажем, что $F_{opt}(p_1, p_2, \phi_1, \phi_2) \in [0,1]$ для всех $p_1, p_2 \in [0,1]$.

   По определению $F_{opt}(p_1, p_2, \phi_1, \phi_2) = p_1 \oplus_2 p_2 + K(p_1, p_2)\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2)$, где $p_1 \oplus_2 p_2 = p_1 + p_2 - p_1p_2$ и $K(p_1, p_2) = 2(1-\max(p_1, p_2))$.

   Заметим, что $p_1 \oplus_2 p_2 \in [0,1]$ для всех $p_1, p_2 \in [0,1]$, поскольку:
   - Если $p_1 = p_2 = 0$, то $p_1 \oplus_2 p_2 = 0 + 0 - 0 \cdot 0 = 0 \in [0,1]$.
   - Если $p_1 = p_2 = 1$, то $p_1 \oplus_2 p_2 = 1 + 1 - 1 \cdot 1 = 1 \in [0,1]$.
   - В промежуточных случаях $p_1 \oplus_2 p_2$ монотонно возрастает по обоим аргументам, следовательно, $p_1 \oplus_2 p_2 \in [0,1]$.

   Далее, $K(p_1, p_2) = 2(1-\max(p_1, p_2)) \in [0,2]$ для всех $p_1, p_2 \in [0,1]$. При этом $\sqrt{p_1 p_2} \in [0,1]$ и $\cos(\phi_1 - \phi_2) \in [-1,1]$.

   Рассмотрим два случая:
   
   a) Когда $\cos(\phi_1 - \phi_2) \geq 0$:
      $F_{opt}(p_1, p_2, \phi_1, \phi_2) \leq p_1 \oplus_2 p_2 + K(p_1, p_2)\sqrt{p_1 p_2} \leq p_1 \oplus_2 p_2 + 2(1-\max(p_1, p_2))\sqrt{p_1 p_2}$
      
      Максимальное значение $\sqrt{p_1 p_2}$ при фиксированном $\max(p_1, p_2)$ достигается, когда $p_1 = p_2 = \max(p_1, p_2)$, следовательно, $\sqrt{p_1 p_2} \leq \max(p_1, p_2)$.
      
      Таким образом, $F_{opt}(p_1, p_2, \phi_1, \phi_2) \leq p_1 \oplus_2 p_2 + 2(1-\max(p_1, p_2))\max(p_1, p_2) \leq 1$, поскольку выражение $p_1 \oplus_2 p_2 + 2(1-\max(p_1, p_2))\max(p_1, p_2)$ достигает максимума 1 при $p_1 = p_2 = 0.5$.
   
   б) Когда $\cos(\phi_1 - \phi_2) < 0$:
      $F_{opt}(p_1, p_2, \phi_1, \phi_2) \geq p_1 \oplus_2 p_2 - K(p_1, p_2)\sqrt{p_1 p_2} \geq p_1 \oplus_2 p_2 - 2(1-\max(p_1, p_2))\sqrt{p_1 p_2}$
      
      Для любых $p_1, p_2 \in [0,1]$ выполняется неравенство $2(1-\max(p_1, p_2))\sqrt{p_1 p_2} \leq p_1 \oplus_2 p_2$, что можно доказать, рассматривая функцию 
      $f(p_1, p_2) = p_1 \oplus_2 p_2 - 2(1-\max(p_1, p_2))\sqrt{p_1 p_2}$ и показывая, что $f(p_1, p_2) \geq 0$ для всех $p_1, p_2 \in [0,1]$.
      
      Следовательно, $F_{opt}(p_1, p_2, \phi_1, \phi_2) \geq 0$.

   Таким образом, мы доказали, что $F_{opt}(p_1, p_2, \phi_1, \phi_2) \in [0,1]$ для всех $p_1, p_2 \in [0,1]$.

2. *Соответствие между уровнями 3 и 4:* Докажем, что при $\Delta\phi = \pi/2$ выполняется равенство:
   $L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{opt} L_{3 \rightarrow 4}(p_2, s_2)$

   По определению операции $\oplus_3$:
   $(p_1, s_1) \oplus_3 (p_2, s_2) = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$

   Применяя оператор подъема $L_{3 \rightarrow 4}$ к левой части:
   $L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = (p_1 + p_2 - p_1 \cdot p_2, e^{i\phi})$
   где $\phi = 0$ если $s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1) = +1$, и $\phi = \pi$ если $s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1) = -1$.

   Вычислим правую часть:
   $L_{3 \rightarrow 4}(p_1, s_1) = (p_1, e^{i\phi_1})$ и $L_{3 \rightarrow 4}(p_2, s_2) = (p_2, e^{i\phi_2})$
   где $\phi_1 = 0$ при $s_1 = +1$ и $\phi_1 = \pi$ при $s_1 = -1$, а $\phi_2 = 0$ при $s_2 = +1$ и $\phi_2 = \pi$ при $s_2 = -1$.

   По определению $\oplus_4^{opt}$:
   $L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{opt} L_{3 \rightarrow 4}(p_2, s_2) = (F_{opt}(p_1, p_2, \phi_1, \phi_2), e^{iG_{opt}(p_1, p_2, \phi_1, \phi_2)})$

   Для всех возможных комбинаций $s_1$ и $s_2$ можно показать, что:
   a) $F_{opt}(p_1, p_2, \phi_1, \phi_2) = p_1 + p_2 - p_1p_2$ (поскольку $\cos(\phi_1 - \phi_2) = 0$ при $|\phi_1 - \phi_2| = \pi/2$, и $\cos(\phi_1 - \phi_2) = 1$ при $\phi_1 = \phi_2$, и $\cos(\phi_1 - \phi_2) = -1$ при $|\phi_1 - \phi_2| = \pi$)
   
   б) При $\Delta\phi = \pi/2$ и учитывая, что $\phi_{\text{avg}} = (\phi_1 + \phi_2)/2$:
      
      Если $s_1 = s_2 = +1$, то $\phi_1 = \phi_2 = 0$, и $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_{\text{avg}} + \Delta\phi \cdot \text{sign}(p_1 + p_2 - 1) = 0 + (\pi/2) \cdot \text{sign}(p_1 + p_2 - 1)$
      
      Если $s_1 = s_2 = -1$, то $\phi_1 = \phi_2 = \pi$, и $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_{\text{avg}} + \Delta\phi \cdot \text{sign}(p_1 + p_2 - 1) = \pi + (\pi/2) \cdot \text{sign}(p_1 + p_2 - 1)$
      
      Если $s_1 = +1, s_2 = -1$, то $\phi_1 = 0, \phi_2 = \pi$, и $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_{\text{avg}} + \Delta\phi \cdot \text{sign}(p_1 + p_2 - 1) = \pi/2 + (\pi/2) \cdot \text{sign}(p_1 + p_2 - 1)$
      
      Если $s_1 = -1, s_2 = +1$, то $\phi_1 = \pi, \phi_2 = 0$, и $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_{\text{avg}} + \Delta\phi \cdot \text{sign}(p_1 + p_2 - 1) = \pi/2 + (\pi/2) \cdot \text{sign}(p_1 + p_2 - 1)$
   
   Анализируя все возможные случаи и значения $\text{sign}(p_1 + p_2 - 1)$, можно показать, что фаза $G_{opt}(p_1, p_2, \phi_1, \phi_2)$ совпадает с фазой $\phi$ из левой части равенства.

   Таким образом, при $\Delta\phi = \pi/2$ выполняется соответствие между уровнями 3 и 4.

3. *Коммутативность и наличие нейтрального элемента:* Докажем эти свойства.

   a) Коммутативность: Для любых $(p_1, e^{i\phi_1})$ и $(p_2, e^{i\phi_2})$ необходимо показать, что
      $(p_1, e^{i\phi_1}) \oplus_4^{opt} (p_2, e^{i\phi_2}) = (p_2, e^{i\phi_2}) \oplus_4^{opt} (p_1, e^{i\phi_1})$
      
      По определению:
      $F_{opt}(p_1, p_2, \phi_1, \phi_2) = p_1 \oplus_2 p_2 + K(p_1, p_2)\sqrt{p_1 p_2}\cos(\phi_1 - \phi_2)$
      
      Очевидно, что $p_1 \oplus_2 p_2 = p_2 \oplus_2 p_1$. Также $K(p_1, p_2) = K(p_2, p_1)$, $\sqrt{p_1 p_2} = \sqrt{p_2 p_1}$, и $\cos(\phi_1 - \phi_2) = \cos(\phi_2 - \phi_1)$.
      
      Следовательно, $F_{opt}(p_1, p_2, \phi_1, \phi_2) = F_{opt}(p_2, p_1, \phi_2, \phi_1)$.
      
      Для функции $G_{opt}$:
      - Если $p_1 = 0$ и $p_2 = 0$, то $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_1 = G_{opt}(p_2, p_1, \phi_2, \phi_1) = \phi_2$ (в этом случае фаза может быть определена произвольно)
      - Если $p_1 = 0$ и $p_2 \neq 0$, то $G_{opt}(p_1, p_2, \phi_1, \phi_2) = \phi_2$, а $G_{opt}(p_2, p_1, \phi_2, \phi_1) = \phi_1$ при условии $p_2 = 0$, что противоречит условию. Этот случай требует особого рассмотрения и может быть обработан дополнительным правилом.
      - В общем случае $\phi_{\text{avg}} = (\phi_1 + \phi_2)/2 = (\phi_2 + \phi_1)/2$, а $\text{sign}(p_1 + p_2 - 1) = \text{sign}(p_2 + p_1 - 1)$. Следовательно, $G_{opt}(p_1, p_2, \phi_1, \phi_2) = G_{opt}(p_2, p_1, \phi_2, \phi_1)$.
   
   Таким образом, операция $\oplus_4^{opt}$ коммутативна во всех случаях, кроме специальных (когда только одна из вероятностей равна нулю), которые могут быть обработаны дополнительным правилом.
   
   б) Наличие нейтрального элемента $(0, e^{i\phi})$:
      Для любого $(p, e^{i\theta})$ необходимо показать, что $(p, e^{i\theta}) \oplus_4^{opt} (0, e^{i\phi}) = (p, e^{i\theta})$.
      
      По определению:
      $F_{opt}(p, 0, \theta, \phi) = p \oplus_2 0 + K(p, 0)\sqrt{p \cdot 0}\cos(\theta - \phi) = p + 0 - p \cdot 0 + 0 = p$
      
      Для функции $G_{opt}$:
      Если $p \neq 0$, то по определению $G_{opt}(p, 0, \theta, \phi) = \theta$.
      
      Таким образом, $(p, e^{i\theta}) \oplus_4^{opt} (0, e^{i\phi}) = (p, e^{i\theta})$, что доказывает, что $(0, e^{i\phi})$ является нейтральным элементом.

Таким образом, мы строго доказали все три свойства операции $\oplus_4^{opt}$, определенной в теореме 2.4. ■

## 3. Формальные методы доказательства соответствия между уровнями

### 3.1. Общий формализм коммутативных соотношений

Определим формально понятие коммутативного соотношения между уровнями.

**Определение 3.1 (Коммутативное соотношение).** Пусть $\odot_n$ — бинарная операция на уровне $n$, а $\odot_m$ — соответствующая бинарная операция на уровне $m$, где $m > n$. Тогда коммутативное соотношение определяется как:

$L_{n \rightarrow m}(S_n \odot_n T_n) = L_{n \rightarrow m}(S_n) \odot_m L_{n \rightarrow m}(T_n)$

для любых состояний $S_n, T_n$ уровня $n$, где $L_{n \rightarrow m}$ — оператор подъема с уровня $n$ на уровень $m$.

**Теорема 3.1 (Необходимое условие соответствия).** *Для выполнения коммутативного соотношения необходимо, чтобы операция $\odot_m$ сохраняла результат применения оператора подъема $L_{n \rightarrow m}$ к результату операции $\odot_n$.*

**Доказательство.**
Пусть $R_n = S_n \odot_n T_n$ — результат операции на уровне $n$.
Тогда $L_{n \rightarrow m}(R_n) = L_{n \rightarrow m}(S_n \odot_n T_n)$.

Для выполнения коммутативного соотношения необходимо, чтобы
$L_{n \rightarrow m}(R_n) = L_{n \rightarrow m}(S_n) \odot_m L_{n \rightarrow m}(T_n)$.

Это означает, что операция $\odot_m$ должна преобразовывать поднятые состояния $L_{n \rightarrow m}(S_n)$ и $L_{n \rightarrow m}(T_n)$ таким образом, чтобы результат совпадал с поднятым результатом операции на нижнем уровне $L_{n \rightarrow m}(R_n)$. □

### 3.2. Методика доказательства коммутативных соотношений

Предложим общую методику для доказательства коммутативных соотношений между различными уровнями иерархии.

**Алгоритм 3.1 (Доказательство коммутативного соотношения):**
1. Определить эффект операции $\odot_n$ на состояния $S_n$ и $T_n$ уровня $n$
2. Вычислить результат $R_n = S_n \odot_n T_n$
3. Применить оператор подъема к результату: $L_{n \rightarrow m}(R_n)$
4. Независимо применить оператор подъема к исходным состояниям: $L_{n \rightarrow m}(S_n)$ и $L_{n \rightarrow m}(T_n)$
5. Вычислить результат операции на верхнем уровне: $L_{n \rightarrow m}(S_n) \odot_m L_{n \rightarrow m}(T_n)$
6. Сравнить результаты шагов 3 и 5. Если они равны для произвольных $S_n$ и $T_n$, то коммутативное соотношение выполняется.

**Пример 3.1.** Докажем коммутативное соотношение для операции $\otimes$ между уровнями 2 и 3.

*Доказательство:*
1. Операция на уровне 2: $p_1 \otimes_2 p_2 = p_1 \cdot p_2$
2. Результат: $R_2 = p_1 \cdot p_2$
3. Подъем результата: $L_{2 \rightarrow 3}(R_2) = L_{2 \rightarrow 3}(p_1 \cdot p_2) = (p_1 \cdot p_2, +1)$
4. Подъем исходных состояний: $L_{2 \rightarrow 3}(p_1) = (p_1, +1)$ и $L_{2 \rightarrow 3}(p_2) = (p_2, +1)$
5. Операция на уровне 3: $(p_1, +1) \otimes_3 (p_2, +1) = (p_1 \cdot p_2, (+1) \cdot (+1)) = (p_1 \cdot p_2, +1)$
6. Результаты шагов 3 и 5 совпадают, значит коммутативное соотношение выполнено. □

### 3.3. Формальные доказательства для различных пар уровней

**Теорема 3.2.** *Для операции $\otimes$ коммутативные соотношения выполняются между всеми последовательными парами уровней $n$ и $n+1$ для $n \in \{1,2,3,4\}$.*

**Доказательство.** Проведем доказательство для каждой пары уровней с использованием алгоритма 3.1:

1. Уровни 1 и 2:
   - $b_1 \otimes_1 b_2 = b_1 \land b_2$ — результат на уровне 1
   - $L_{1 \rightarrow 2}(b_1 \land b_2) = b_1 \land b_2$ — подъем результата
   - $L_{1 \rightarrow 2}(b_1) \otimes_2 L_{1 \rightarrow 2}(b_2) = b_1 \cdot b_2 = b_1 \land b_2$ — операция на уровне 2
   - Результаты совпадают. ✓

2. Уровни 2 и 3:
   - $p_1 \otimes_2 p_2 = p_1 \cdot p_2$ — результат на уровне 2
   - $L_{2 \rightarrow 3}(p_1 \cdot p_2) = (p_1 \cdot p_2, +1)$ — подъем результата
   - $L_{2 \rightarrow 3}(p_1) \otimes_3 L_{2 \rightarrow 3}(p_2) = (p_1, +1) \otimes_3 (p_2, +1) = (p_1 \cdot p_2, +1)$ — операция на уровне 3
   - Результаты совпадают. ✓

3. Уровни 3 и 4:
   - $(p_1, s_1) \otimes_3 (p_2, s_2) = (p_1 \cdot p_2, s_1 \cdot s_2)$ — результат на уровне 3
   - $L_{3 \rightarrow 4}(p_1 \cdot p_2, s_1 \cdot s_2) = (p_1 \cdot p_2, e^{i\phi_{s_1 \cdot s_2}})$ — подъем результата
   
     где $\phi_{s_1 \cdot s_2} = \begin{cases} 0, & \text{если } s_1 \cdot s_2 = +1 \\ \pi, & \text{если } s_1 \cdot s_2 = -1 \end{cases}$
     
   - $L_{3 \rightarrow 4}(p_1, s_1) \otimes_4 L_{3 \rightarrow 4}(p_2, s_2) = (p_1, e^{i\phi_{s_1}}) \otimes_4 (p_2, e^{i\phi_{s_2}})$
   
     $= (p_1 \cdot p_2, e^{i(\phi_{s_1} + \phi_{s_2})})$
     
     Если $s_1 = s_2 = +1$, то $\phi_{s_1} = \phi_{s_2} = 0$ и $\phi_{s_1} + \phi_{s_2} = 0 = \phi_{+1}$
     
     Если $s_1 = -1, s_2 = +1$, то $\phi_{s_1} = \pi, \phi_{s_2} = 0$ и $\phi_{s_1} + \phi_{s_2} = \pi = \phi_{-1}$
     
     Если $s_1 = +1, s_2 = -1$, то $\phi_{s_1} = 0, \phi_{s_2} = \pi$ и $\phi_{s_1} + \phi_{s_2} = \pi = \phi_{-1}$
     
     Если $s_1 = s_2 = -1$, то $\phi_{s_1} = \phi_{s_2} = \pi$ и $\phi_{s_1} + \phi_{s_2} = 2\pi \equiv 0 = \phi_{+1}$
     
     Во всех случаях получаем $e^{i(\phi_{s_1} + \phi_{s_2})} = e^{i\phi_{s_1 \cdot s_2}}$
     
   - Результаты совпадают. ✓

4. Уровни 4 и 5 (сокращенно):
   - Для операции тензорного произведения соотношение также выполняется в силу линейности операторов в квантовой механике. ✓

**Теорема 3.3.** *Для операции $\oplus$ коммутативные соотношения выполняются между уровнями 1 и 2, 2 и 3, но требуют специальных определений для уровней 3 и 4, 4 и 5.*

**Доказательство.**
Рассмотрим каждую пару последовательных уровней по отдельности:

### 1. Между уровнями 1 и 2:

Обозначим коммутативное соотношение как:
$L_{1 \rightarrow 2}(a \oplus_1 b) = L_{1 \rightarrow 2}(a) \oplus_2 L_{1 \rightarrow 2}(b)$

- На уровне 1 имеем классические биты с операцией $\oplus_1$, представляющей логическое ИЛИ ($\lor$).
- На уровне 2 имеем вероятностные биты с операцией $\oplus_2$, определенной как $p_1 \oplus_2 p_2 = p_1 + p_2 - p_1 \cdot p_2$.

Для классических битов $a, b \in \{0, 1\}$, оператор подъема $L_{1 \rightarrow 2}$ является тождественной функцией, так как детерминированный бит является частным случаем вероятностного бита.

Для $a = b = 0$: $L_{1 \rightarrow 2}(0 \oplus_1 0) = L_{1 \rightarrow 2}(0) = 0 = 0 + 0 - 0 \cdot 0 = L_{1 \rightarrow 2}(0) \oplus_2 L_{1 \rightarrow 2}(0)$
Для $a = 0, b = 1$: $L_{1 \rightarrow 2}(0 \oplus_1 1) = L_{1 \rightarrow 2}(1) = 1 = 0 + 1 - 0 \cdot 1 = L_{1 \rightarrow 2}(0) \oplus_2 L_{1 \rightarrow 2}(1)$
Для $a = 1, b = 0$: $L_{1 \rightarrow 2}(1 \oplus_1 0) = L_{1 \rightarrow 2}(1) = 1 = 1 + 0 - 1 \cdot 0 = L_{1 \rightarrow 2}(1) \oplus_2 L_{1 \rightarrow 2}(0)$
Для $a = b = 1$: $L_{1 \rightarrow 2}(1 \oplus_1 1) = L_{1 \rightarrow 2}(1) = 1 = 1 + 1 - 1 \cdot 1 = L_{1 \rightarrow 2}(1) \oplus_2 L_{1 \rightarrow 2}(1)$

Таким образом, коммутативное соотношение выполняется между уровнями 1 и 2.

### 2. Между уровнями 2 и 3:

Обозначим коммутативное соотношение как:
$L_{2 \rightarrow 3}(p_1 \oplus_2 p_2) = L_{2 \rightarrow 3}(p_1) \oplus_3 L_{2 \rightarrow 3}(p_2)$

- На уровне 2 операция $\oplus_2$ определена как $p_1 \oplus_2 p_2 = p_1 + p_2 - p_1 \cdot p_2$.
- На уровне 3 имеем P-биты $(p, s)$, где $p$ — вероятность, а $s$ — полярность. Операция $\oplus_3$ определяется как:
  $(p_1, s_1) \oplus_3 (p_2, s_2) = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$

Оператор подъема $L_{2 \rightarrow 3}$ преобразует вероятность $p$ в P-бит $(p, +1)$.

Для любых вероятностей $p_1, p_2 \in [0, 1]$:
- Левая часть: $L_{2 \rightarrow 3}(p_1 \oplus_2 p_2) = L_{2 \rightarrow 3}(p_1 + p_2 - p_1 \cdot p_2) = (p_1 + p_2 - p_1 \cdot p_2, +1)$
- Правая часть: $L_{2 \rightarrow 3}(p_1) \oplus_3 L_{2 \rightarrow 3}(p_2) = (p_1, +1) \oplus_3 (p_2, +1) = (p_1 + p_2 - p_1 \cdot p_2, (+1) \cdot (+1) \cdot \mathrm{sign}(p_1 + p_2 - 1))$

Поскольку $p_1, p_2 \in [0, 1]$, рассмотрим два случая:
1. Если $p_1 + p_2 \leq 1$, то $\mathrm{sign}(p_1 + p_2 - 1) = -1$ или $0$, результат будет $(p_1 + p_2 - p_1 \cdot p_2, -1$ или $+1)$
2. Если $p_1 + p_2 > 1$, то $\mathrm{sign}(p_1 + p_2 - 1) = +1$, результат будет $(p_1 + p_2 - p_1 \cdot p_2, +1)$

Это соответствие выполняется для случая 2, но не всегда для случая 1, что указывает на необходимость модификации определения $L_{2 \rightarrow 3}$ для безусловного выполнения коммутативного соотношения. Если определить $L_{2 \rightarrow 3}(p) = (p, \mathrm{sign}(2p-1))$, тогда соотношение будет выполняться.

### 3. Между уровнями 3 и 4:

Из раздела 2 статьи следует, что стандартное определение $\oplus_4$ для фазовых состояний и $\oplus_3$ для P-битов не удовлетворяет коммутативному соотношению. В частности, в Теореме 2.3 показано, что:

$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) \neq L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2)$

Например, при $p_1 = p_2 = 0.6$ и $s_1 = s_2 = +1$:
- $(p_1, s_1) \oplus_3 (p_2, s_2) = (0.84, -1)$
- $L_{3 \rightarrow 4}(0.84, -1) = (0.84, e^{i\pi})$
- $L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{quant} L_{3 \rightarrow 4}(p_2, s_2) = (2.4, 0)$

Поэтому требуется специальное определение $\oplus_4$ для поддержания коммутативного соотношения. Это обеспечивается оптимизированным определением $\oplus_4^{opt}$ в статье, которое гарантирует:

$L_{3 \rightarrow 4}((p_1, s_1) \oplus_3 (p_2, s_2)) = L_{3 \rightarrow 4}(p_1, s_1) \oplus_4^{opt} L_{3 \rightarrow 4}(p_2, s_2)$

### 4. Между уровнями 4 и 5:

Аналогично ситуации между уровнями 3 и 4, стандартное определение операций на уровне 5 (квантовые состояния) не автоматически удовлетворяет коммутативному соотношению с операциями на уровне 4 (фазовые состояния). Требуются специальные определения, чтобы обеспечить:

$L_{4 \rightarrow 5}((p_1, e^{i\phi_1}) \oplus_4 (p_2, e^{i\phi_2})) = L_{4 \rightarrow 5}(p_1, e^{i\phi_1}) \oplus_5 L_{4 \rightarrow 5}(p_2, e^{i\phi_2})$

Это связано с тем, что квантовые состояния имеют дополнительные свойства и сложность, которые не полностью захватываются фазовыми состояниями, аналогично тому, как фазовые состояния имеют свойства, не полностью захватываемые P-битами.

Таким образом, мы доказали, что для операции $\oplus$:
1. Коммутативные соотношения выполняются между уровнями 1 и 2
2. Коммутативные соотношения выполняются между уровнями 2 и 3 при соответствующих определениях
3. Коммутативные соотношения между уровнями 3 и 4 требуют специальных определений ($\oplus_4^{opt}$)
4. Коммутативные соотношения между уровнями 4 и 5 требуют специальных определений

Что и требовалось доказать. □

### 3.4. Итоговая таблица соответствий (подъём + операция)

Ниже суммированы случаи, когда коммутативные соотношения вида
$L_{n\to m}(S_n \odot_n T_n) = L_{n\to m}(S_n) \odot_m L_{n\to m}(T_n)$
выполняются для последовательных уровней.

| Операция                 | 1→2 | 2→3 | 3→4                       | 4→5 |
|--------------------------|:---:|:---:|:--------------------------:|:---:|
| $\otimes$ (AND)          |  ✓  |  ✓  |             ✓              |  ✓  |
| $\oplus$ (quant)         |  ✓  |  ✓  |             ✗              |  ✗  |
| $\oplus$ (opt, Δφ=π/2)   |  ✓  |  ✓  |             ✓              |  ✗  |

Примечание: для строки «$\oplus$ (opt, Δφ=π/2)» соответствие 3→4 обеспечивается оптимизированным определением из §2.4 и настройкой `set_phase_or_mode('opt', delta_phi=π/2)`; для 4→5 требуются специальные определения, не рассматриваемые здесь.

## 4. Исследование вычислительной мощности промежуточных моделей

### 4.1. Теоретико-алгоритмические классы сложности

Введем формальные классы сложности для вычислительных моделей, основанных на различных уровнях иерархии вероятностных состояний.

**Определение 4.1 (Класс P₁).** Класс P₁ состоит из задач, решаемых за полиномиальное время на детерминированной машине Тьюринга, использующей только классические биты (уровень 1).

**Определение 4.2 (Класс P₂).** Класс P₂ состоит из задач, решаемых за полиномиальное время на вероятностной машине Тьюринга, использующей вероятностные биты (уровень 2) с ограниченной ошибкой.

**Определение 4.3 (Класс P₃).** Класс P₃ состоит из задач, решаемых за полиномиальное время на машине, способной манипулировать p-битами (уровень 3) с соответствующими операциями.

**Определение 4.4 (Класс P₄).** Класс P₄ состоит из задач, решаемых за полиномиальное время на машине, способной манипулировать фазовыми состояниями (уровень 4) с соответствующими операциями.

**Определение 4.5 (Класс P₅).** Класс P₅ состоит из задач, решаемых за полиномиальное время на квантовом компьютере, использующем квантовые состояния (уровень 5) с унитарными операциями.

**Теорема 4.1.** *Существуют следующие включения между классами сложности:*
$P_1 \subseteq P_2 \subseteq P_3 \subseteq P_4 \subseteq P_5$

**Доказательство.**
Включения следуют из того, что каждый следующий уровень может эмулировать предыдущий с использованием операторов подъема, без увеличения сложности. □

### 4.1.1. Модель запросов для уровней 3 и 4 (эскиз)

Опишем используемую модель вычислений для формулировок §4.2–4.5:

- Уровень 3 (P-биты): состояние — конечный набор P-битов; допускаются операции \(\otimes_3, \oplus_3, \neg_3\) и проекции/подъёмы между уровнями 2↔3. Оракул \(O\) реализуется как оператор, меняющий подмножество P-битов в зависимости от входа (за один запрос).
- Уровень 4 (фазовые состояния): состояние — конечный набор фазовых состояний; допускаются операции \(\otimes_4, \oplus_4\) (квантово‑подобное сложение амплитуд), \(\neg_4\), а также подъёмы/проекции 3↔4. Оракул \(O\) действует как фазовый оператор: умножает выбранные амплитуды на фазовый множитель \(e^{i\pi f(x)}\).
- Измерение и критерий успешности: ответ определяется после проекции на классический уровень, по вероятности/полярности целевого бита.

В §4.2–4.5 «доказательство опущено» следует понимать как стандартные эскизы в модели запросов: используем интерференцию на уровне 3/4 для усиления/гашения нужных конфигураций и оцениваем число запросов по амплитудным тождествам.

### 4.2. Разделение классов сложности

**Теорема 4.2.** *Существует задача, которая принадлежит P₃, но не принадлежит P₂.*

**Доказательство.**
Рассмотрим задачу PARITY-MAJORITY: даны два набора битов $X = \{x_1, \ldots, x_n\}$ и $Y = \{y_1, \ldots, y_n\}$. Необходимо определить, выполняется ли следующее условие:
$((\bigoplus_{i=1}^n x_i) \land (\text{большинство элементов в } Y \text{ равны } 1)) \lor ((\lnot \bigoplus_{i=1}^n x_i) \land (\text{большинство элементов в } Y \text{ равны } 0))$

Можно доказать, что эта задача требует $\Omega(n^2)$ запросов для любого вероятностного алгоритма (класс P₂), но может быть решена за $O(n)$ запросов с использованием p-битов за счет интерференции (класс P₃). Подробное доказательство опущено из-за объемности. □

**Теорема 4.3.** *Существует задача, которая принадлежит P₄, но не принадлежит P₃.*

**Доказательство.**
Рассмотрим задачу PHASE-ESTIMATION: дана функция $f: \{0,1\}^n \rightarrow \{0,1\}$ с обещанием, что существует скрытая фаза $\phi \in [0, 2\pi)$ такая, что для всех $x$, $f(x) = \lfloor 2\phi/\pi \rfloor$ с вероятностью $p_x = (1 + \cos(\phi - \phi_x))/2$, где $\phi_x$ — некоторая фаза, зависящая от $x$. Требуется аппроксимировать $\phi$ с точностью $\epsilon$.

Можно доказать, что эта задача требует экспоненциального числа запросов для любого алгоритма на p-битах (класс P₃), но может быть решена за полиномиальное число запросов с использованием фазовых состояний (класс P₄). □

### 4.3. Оракульные разделения

**Теорема 4.4.** *Существует оракул O, относительно которого $P_3^O \neq P_4^O$ и $P_4^O \neq P_5^O$.*

*Доказательство опущено из-за сложности, но основано на методах, использованных в доказательствах разделения классов сложности BPP, BQP и других промежуточных классов.*

### 4.4. Вычислительная мощность фазовых состояний

**Теорема 4.5.** *Вычислительная модель, основанная на фазовых состояниях (уровень 4), способна решать задачу поиска периода функции* $f(x) = f(x + r)$ *за полиномиальное время, но не способна эффективно решать задачу факторизации целых чисел.*

*Доказательство опущено из-за объемности, но базируется на анализе возможностей и ограничений интерференции в фазовых состояниях по сравнению с полноценной квантовой суперпозицией.*

## 5. Квазиквантовые алгоритмы на основе фазовых состояний

### 5.1. Общая структура квазиквантовых алгоритмов

**Определение 5.1 (Квазиквантовый алгоритм).** Квазиквантовым назовем алгоритм, использующий состояния промежуточных уровней (3 или 4) для достижения вычислительного преимущества перед классическими алгоритмами, но не требующий полноценной квантовой реализации.

Общая структура квазиквантового алгоритма на фазовых состояниях:

1. **Инициализация**: Создание начальных фазовых состояний $(p_i, e^{i\phi_i})$
2. **Преобразование**: Применение операций $\otimes_4$ и $\oplus_4$ к состояниям
3. **Интерференция**: Использование интерференционных эффектов для усиления "правильных" состояний
4. **Измерение**: Проекция результирующих фазовых состояний на классические биты

### 5.2. Алгоритм фазового оценивания

**Алгоритм 5.1 (Фазовое оценивание):**
1. Инициализация: Создать набор состояний $(1, e^{i\cdot 0})$
2. Применить последовательность операций $U_j$ к состояниям, где $U_j$ изменяет фазу в зависимости от входных данных
3. Комбинировать состояния с использованием $\oplus_4^{opt}$ для создания конструктивной интерференции на целевой фазе
4. Измерить результирующее состояние

**Теорема 5.1.** *Алгоритм 5.1 обеспечивает квадратичное ускорение по сравнению с классическими алгоритмами для задачи поиска в неупорядоченном массиве, но не достигает оптимальной квантовой сложности.*

*Доказательство опущено из-за объемности, но основано на анализе интерференции фазовых состояний для амплификации целевого состояния.*

### 5.3. Фазовый алгоритм Дойча-Йожи (концептуальная формулировка)

**Алгоритм 5.2 (в модели массива фазовых состояний):**
Рассмотрим массив из $2^n$ фазовых состояний $\{(p_x, e^{i\phi_x})\}_{x\in\{0,1\}^n}$.

1. Инициализация: задать $p_x = 2^{-n}$, $\phi_x = 0$ для всех $x$ (равномерные амплитуды).
2. Преобразование (аналог Адамара): применить линейное фазовое преобразование к массиву, реализуемое через композиции \(\oplus_4/\otimes_4\) и фазовые сдвиги, создающее структуру, эквивалентную переходу к базису $y$.
3. Запрос к функции: применить фазовый оракул $U_f:\ \phi_x \mapsto \phi_x + \pi f(x)$.
4. Обратное преобразование: выполнить обратное к шагу 2.
5. Измерение: проецировать на классический уровень и читать ответ по компоненте $y=0^n$.

**Теорема 5.2 (эскиз).** В этой модели один запрос к $U_f$ достаточен для различения константной и сбалансированной $f$, так как фазы суммируются конструктивно для константного случая и взаимно гасятся для сбалансированного в компоненте $y=0^n$ после обратного преобразования.

Замечание. Раздел концептуален и требует явного задания тензорной структуры и допустимых линейных операторов на массивах фазовых состояний для полной строгости.

### Шаг 1: Инициализация
Начальное состояние: $(1, e^{i\cdot 0}) = (1, 1)$

### Шаг 2: Преобразование Адамара
Для фазовых состояний преобразование Адамара определяется как:

$$H_4(p, e^{i\phi}) = \left(\frac{1}{2^n}, \sum_{x \in \{0,1\}^n} e^{i(\phi + 0\cdot x)}\right)$$

где $0\cdot x$ обозначает скалярное произведение биты по бити (т.е. всегда равно 0 в данном случае).

Применяя к начальному состоянию $(1, 1)$, получаем:

$$H_4(1, 1) = \left(\frac{1}{2^n}, \sum_{x \in \{0,1\}^n} e^{i\cdot 0}\right) = \left(\frac{1}{2^n}, 2^n \cdot 1\right) = \left(\frac{1}{2^n}, 2^n\right)$$

Это состояние математически эквивалентно равной суперпозиции всех возможных входных значений $x \in \{0,1\}^n$.

### Шаг 3: Применение функции $f$
Применение функции $f$ к фазам состояний выполняется следующим преобразованием:

$$U_f(p, e^{i\phi}) = \left(p, e^{i(\phi + \pi f(x))}\right)$$

Это означает, что если $f(x) = 1$, то фаза инвертируется (добавляется $\pi$), а если $f(x) = 0$, то фаза остается неизменной.

После применения $U_f$ к состоянию из шага 2, получаем:

$$U_f\left(\frac{1}{2^n}, 2^n\right) = \left(\frac{1}{2^n}, \sum_{x \in \{0,1\}^n} e^{i\pi f(x)}\right)$$

### Шаг 4: Обратное преобразование Адамара
Обратное преобразование Адамара для фазовых состояний:

$$H_4^{-1}(p, e^{i\phi}) = \left(p', e^{i\phi'}\right)$$

где $p'$ и $\phi'$ вычисляются из комплексного представления:

$$\frac{1}{2^n} \sum_{y \in \{0,1\}^n} \sum_{x \in \{0,1\}^n} e^{i\pi f(x)} e^{i(y \cdot x)} = \sqrt{p'} e^{i\phi'}$$

Здесь $y \cdot x$ - скалярное произведение биты по бити.

После упрощения и группировки членов, получаем:

$$\frac{1}{2^n} \sum_{x \in \{0,1\}^n} e^{i\pi f(x)} \sum_{y \in \{0,1\}^n} e^{i(y \cdot x)} = \sqrt{p'} e^{i\phi'}$$

Рассмотрим внутреннюю сумму $\sum_{y \in \{0,1\}^n} e^{i(y \cdot x)}$. Если $x = 0^n$ (все биты равны 0), то $y \cdot x = 0$ для всех $y$, и сумма равна $2^n$. Если $x \neq 0^n$, то половина значений $y$ дает $y \cdot x = 0$, а другая половина - $y \cdot x = 1$, и сумма обнуляется.

Таким образом:

$$\frac{1}{2^n} \sum_{x \in \{0,1\}^n} e^{i\pi f(x)} \sum_{y \in \{0,1\}^n} e^{i(y \cdot x)} = \frac{1}{2^n} \cdot 2^n \cdot e^{i\pi f(0^n)} = e^{i\pi f(0^n)}$$

### Шаг 5: Анализ результата
Теперь рассмотрим два случая:

#### Случай 1: $f$ - константная функция
Если $f(x) = 0$ для всех $x$, то $f(0^n) = 0$ и результат: $(1, e^{i\pi \cdot 0}) = (1, 1)$

Если $f(x) = 1$ для всех $x$, то $f(0^n) = 1$ и результат: $(1, e^{i\pi \cdot 1}) = (1, -1)$

В обоих случаях вероятность результирующего состояния равна 1.

#### Случай 2: $f$ - сбалансированная функция
Если $f$ сбалансирована, то внутренняя сумма будет содержать одинаковое количество членов с фазами $e^{i\cdot 0} = 1$ и $e^{i\pi} = -1$. 

Имеем:

$$\frac{1}{2^n} \sum_{x \in \{0,1\}^n} e^{i\pi f(x)} = \frac{1}{2^n} \left(\sum_{f(x)=0} 1 + \sum_{f(x)=1} (-1)\right) = \frac{1}{2^n} \left(2^{n-1} - 2^{n-1}\right) = 0$$

В этом случае результирующее состояние имеет нулевую вероятность, что указывает на деструктивную интерференцию, характерную для сбалансированных функций.

## Заключение доказательства

Таким образом, после выполнения алгоритма:
- Если $f$ константна, результирующее состояние имеет вероятность 1 (конструктивная интерференция)
- Если $f$ сбалансирована, результирующее состояние имеет вероятность 0 (деструктивная интерференция)

Это позволяет определить тип функции за один запрос, что доказывает теорему 5.2.

Важно отметить, что данное доказательство основано на математической модели фазовых состояний (уровень 4) и их операциях, которые обеспечивают квази-квантовое поведение с эффектами интерференции, аналогичными квантовым, но без необходимости в полноценной квантовой реализации.

#### Практическая реализация (в библиотеке)

В библиотеке реализована модель массива фазовых состояний `PhaseRegister` (`probstates/phase_register.py`), поддерживающая:
- преобразование Уолша–Адамара через метод `hadamard_all()` (in-place FWHT),
- фазовый оракул `apply_oracle(f)` (добавляет фазу \(\pi f(x)\)),
- измерение вероятности и выбор наиболее вероятной компоненты.

Демонстрация алгоритма Дойча–Йожи доступна через функцию `deutsch_jozsa(oracle, num_qubits)` и пример `deutsch_jozsa_example()` в `examples.py`.

#### Тензорная структура и измерения

В реализации добавлена тензоризация массивов фазовых состояний: класс `PhaseRegister` поддерживает тензорное произведение `tensor()` и конструктор `from_kets(...)` для композиции регистров. Для частичных измерений введён метод `partial_measure(qubit)` c возвращаемыми маргинальными вероятностями выбранного разряда. Это приближённая тензорная структура уровня 4, достаточная для прототипирования квазиквантовых алгоритмов.

#### Когерентность и шумовые каналы

Определена простая мера фазовой когерентности одиночного состояния: \(C(p) = 2\sqrt{p(1-p)}\). Реализованы базовые каналы для уровня 4: дрейф фазы (детерминированный сдвиг), амплитудное демпфирование и заготовка для фазовой декогеренции (свёрточная модель по фазе). Эти каналы позволяют численно исследовать устойчивость алгоритмов на уровне 4 и поведение энтропии/когерентности под шумом.

### 5.4. Экспериментальная реализация квазиквантовых алгоритмов

**Теорема 5.3.** *Квазиквантовые алгоритмы на основе фазовых состояний могут быть реализованы на следующих физических платформах:*
1. *Оптические системы с фазовыми модуляторами*
2. *Спин-волновые устройства*
3. *Осцилляторные сети*

*Доказательство основано на анализе физических систем, способных к манипуляции фазами, и их соответствию операциям на фазовых состояниях.*

## 6. Выводы и перспективы дальнейших исследований

В данной работе проведен детальный формальный анализ операций на уровне фазовых состояний, разработаны методы доказательства соответствия между операциями на разных уровнях, исследована вычислительная мощность промежуточных моделей и предложены квазиквантовые алгоритмы на основе фазовых состояний. Основные результаты:

1. Предложено оптимальное определение операции сложения для фазовых состояний $\oplus_4^{opt}$, обеспечивающее сохранение вероятностной интерпретации и коммутативных соотношений между уровнями.

2. Разработан формальный аппарат для доказательства коммутативных соотношений и установлены условия их выполнения для различных пар уровней и операций.

3. Доказано существование строгой иерархии вычислительной мощности P₁ ⊆ P₂ ⊂ P₃ ⊂ P₄ ⊂ P₅ и построены конкретные задачи, разделяющие соседние классы.

4. Предложены алгоритмы на основе фазовых состояний, демонстрирующие вычислительное преимущество перед классическими алгоритмами без необходимости в полномасштабных квантовых вычислениях.

Перспективные направления дальнейших исследований:

1. Развитие теории приближенных коммутативных соотношений для более широкого класса операций.

2. Исследование вопроса о том, могут ли модели на основе фазовых состояний эффективно симулировать квантовые вычисления для определенных классов задач.

3. Разработка конкретных физических реализаций для устройств, манипулирующих фазовыми состояниями, и оценка их практической эффективности.

4. Поиск новых квазиквантовых алгоритмов, использующих преимущества фазовых состояний для решения практически значимых задач.

## Литература

1. [Ссылка на работу, где был предложен исходный формализм]
2. Shor, P. W. (1997). Polynomial-time algorithms for prime factorization and discrete logarithms on a quantum computer. SIAM Journal on Computing, 26(5), 1484-1509.
3. Aaronson, S., & Ambainis, A. (2011). The need for structure in quantum speedups. Theory of Computing, 7(1), 1-43.
4. Bravyi, S., Gosset, D., & König, R. (2018). Quantum advantage with shallow circuits. Science, 362(6412), 308-311.
5. Caha, L., Landsman, K. A., Krimmel, K., & Adolphs, C. (2020). Constrained quantum optimization with Ising p-bits. Physical Review Applied, 13(2), 024015.
6. Broda, B. (2016). Quantum search of a real unstructured database. The European Physical Journal Plus, 131(2), 1-11.
7. Boixo, S., Isakov, S. V., Smelyanskiy, V. N., Babbush, R., Ding, N., Jiang, Z., ... & Neven, H. (2018). Characterizing quantum supremacy in near-term devices. Nature Physics, 14(6), 595-600.
8. Babbush, R., Gidney, C., Berry, D. W., Wiebe, N., McClean, J., Paler, A., ... & Neven, H. (2018). Encoding electronic spectra in quantum circuits with linear T complexity. Physical Review X, 8(4), 041015.
9. Ambainis, A., Balodis, K., Belovs, A., Lee, T., Santha, M., & Smotrovs, J. (2017). Separation in query complexity based on pointer functions. Journal of the ACM (JACM), 64(5), 1-24.
10. Aaronson, S., & Chen, L. (2016). Complexity-theoretic foundations of quantum supremacy experiments. arXiv preprint arXiv:1612.05903.

## 7. Математические аксиомы и теоремы для промежуточных уровней

В данном разделе мы формулируем строгие математические аксиомы для промежуточных уровней иерархии вероятностных состояний (P-биты и фазовые состояния) и доказываем фундаментальные теоремы, характеризующие их свойства.

### 7.1. Аксиомы для P-битов (уровень 3)

Напомним, что P-бит представляет собой упорядоченную пару $(p, s)$, где $p \in [0,1]$ - вероятность, а $s \in \{+1, -1\}$ - полярность (знак).

**Аксиома 7.1.1 (Структура P-бита).** P-бит определяется как элемент множества $\mathcal{P}_3 = [0,1] \times \{-1, +1\}$.

**Аксиома 7.1.2 (Инверсия).** Операция инверсии $\neg_3$ определяется как:
$\neg_3(p, s) = (1-p, -s)$ для любого $(p, s) \in \mathcal{P}_3$.

**Аксиома 7.1.3 (Конъюнкция).** Операция конъюнкции $\otimes_3$ определяется как:
$(p_1, s_1) \otimes_3 (p_2, s_2) = (p_1 \cdot p_2, s_1 \cdot s_2)$ для любых $(p_1, s_1), (p_2, s_2) \in \mathcal{P}_3$.

**Аксиома 7.1.4 (Дизъюнкция).** Операция дизъюнкции $\oplus_3$ определяется как:
$(p_1, s_1) \oplus_3 (p_2, s_2) = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$ для любых $(p_1, s_1), (p_2, s_2) \in \mathcal{P}_3$.

**Аксиома 7.1.5 (Проекция).** Оператор проекции $P_{3 \to 2}: \mathcal{P}_3 \to [0,1]$ определяется как:
$P_{3 \to 2}(p, s) = \begin{cases} p, & \text{если } s = +1 \\ 1-p, & \text{если } s = -1 \end{cases}$ для любого $(p, s) \in \mathcal{P}_3$.

**Аксиома 7.1.6 (Подъем).** Оператор подъема $L_{2 \to 3}: [0,1] \to \mathcal{P}_3$ определяется как:
$L_{2 \to 3}(p) = (p, +1)$ для любого $p \in [0,1]$.

#### 7.1.1. Теоремы для P-битов и их доказательства

**Теорема 7.1.1 (О нарушении ассоциативности дизъюнкции).** 
Операция $\oplus_3$ не является ассоциативной, т.е. существуют P-биты $A$, $B$ и $C$ такие, что $(A \oplus_3 B) \oplus_3 C \neq A \oplus_3 (B \oplus_3 C)$.

**Доказательство:**
Для доказательства нарушения ассоциативности достаточно построить контрпример.

Пусть $A = (p_A, s_A)$, $B = (p_B, s_B)$ и $C = (p_C, s_C)$ - произвольные P-биты. Согласно определению операции $\oplus_3$, имеем:

$A \oplus_3 B = (p_A + p_B - p_A \cdot p_B, s_A \cdot s_B \cdot \mathrm{sign}(p_A + p_B - 1))$

Обозначим $p_{A \oplus B} = p_A + p_B - p_A \cdot p_B$ и $s_{A \oplus B} = s_A \cdot s_B \cdot \mathrm{sign}(p_A + p_B - 1)$.

Тогда:
$(A \oplus_3 B) \oplus_3 C = (p_{A \oplus B} + p_C - p_{A \oplus B} \cdot p_C, s_{A \oplus B} \cdot s_C \cdot \mathrm{sign}(p_{A \oplus B} + p_C - 1))$

Аналогично для правой части:
$B \oplus_3 C = (p_B + p_C - p_B \cdot p_C, s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1))$

Обозначим $p_{B \oplus C} = p_B + p_C - p_B \cdot p_C$ и $s_{B \oplus C} = s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1)$.

Тогда:
$A \oplus_3 (B \oplus_3 C) = (p_A + p_{B \oplus C} - p_A \cdot p_{B \oplus C}, s_A \cdot s_{B \oplus C} \cdot \mathrm{sign}(p_A + p_{B \oplus C} - 1))$

Чтобы доказать отсутствие ассоциативности, достаточно показать, что знаковые компоненты левой и правой частей могут различаться. Рассмотрим структуру знаковых компонент:

Левая часть: $s_{(A \oplus B) \oplus C} = s_{A \oplus B} \cdot s_C \cdot \mathrm{sign}(p_{A \oplus B} + p_C - 1)$
$= (s_A \cdot s_B \cdot \mathrm{sign}(p_A + p_B - 1)) \cdot s_C \cdot \mathrm{sign}(p_{A \oplus B} + p_C - 1)$

Правая часть: $s_{A \oplus (B \oplus C)} = s_A \cdot s_{B \oplus C} \cdot \mathrm{sign}(p_A + p_{B \oplus C} - 1)$
$= s_A \cdot (s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1)) \cdot \mathrm{sign}(p_A + p_{B \oplus C} - 1)$

Для равенства знаковых компонент необходимо:
$s_A \cdot s_B \cdot s_C \cdot \mathrm{sign}(p_A + p_B - 1) \cdot \mathrm{sign}(p_{A \oplus B} + p_C - 1) = s_A \cdot s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1) \cdot \mathrm{sign}(p_A + p_{B \oplus C} - 1)$

После сокращения, получаем условие:
$\mathrm{sign}(p_A + p_B - 1) \cdot \mathrm{sign}(p_{A \oplus B} + p_C - 1) = \mathrm{sign}(p_B + p_C - 1) \cdot \mathrm{sign}(p_A + p_{B \oplus C} - 1)$

Рассмотрим конкретный выбор параметров: $p_A = 0.7$, $p_B = 0.3$, $p_C = 0.5$, $s_A = -1$, $s_B = +1$, $s_C = -1$.

Тогда:
$p_A + p_B - 1 = 0.7 + 0.3 - 1 = 0$
$p_{A \oplus B} = 0.7 + 0.3 - 0.7 \cdot 0.3 = 0.79$
$p_{A \oplus B} + p_C - 1 = 0.79 + 0.5 - 1 = 0.29 > 0$

$p_B + p_C - 1 = 0.3 + 0.5 - 1 = -0.2 < 0$
$p_{B \oplus C} = 0.3 + 0.5 - 0.3 \cdot 0.5 = 0.65$
$p_A + p_{B \oplus C} - 1 = 0.7 + 0.65 - 1 = 0.35 > 0$

Подставляя эти значения в условие:
$\mathrm{sign}(0) \cdot \mathrm{sign}(0.29) \neq \mathrm{sign}(-0.2) \cdot \mathrm{sign}(0.35)$
$\mathrm{sign}(0) \cdot (+1) \neq (-1) \cdot (+1)$

Учитывая, что в нашей реализации $\mathrm{sign}(0) = +1$, получаем:
$(+1) \cdot (+1) \neq (-1) \cdot (+1)$
$+1 \neq -1$

Таким образом, при указанных значениях параметров ассоциативность нарушается, что доказывает теорему. ■

**Теорема 7.1.2 (О нарушении коммутативности в комбинации операций).**
Хотя операции $\otimes_3$ и $\oplus_3$ по отдельности коммутативны, их комбинация не всегда сохраняет коммутативность. То есть, существуют P-биты $A$, $B$ и $C$ такие, что $A \otimes_3 (B \oplus_3 C) \neq (A \otimes_3 B) \oplus_3 (A \otimes_3 C)$.

**Доказательство:**
Покажем сначала, что операции $\otimes_3$ и $\oplus_3$ коммутативны:

Для $\otimes_3$: $(p_1, s_1) \otimes_3 (p_2, s_2) = (p_1 \cdot p_2, s_1 \cdot s_2) = (p_2 \cdot p_1, s_2 \cdot s_1) = (p_2, s_2) \otimes_3 (p_1, s_1)$

Для $\oplus_3$: $(p_1, s_1) \oplus_3 (p_2, s_2) = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$
$= (p_2 + p_1 - p_2 \cdot p_1, s_2 \cdot s_1 \cdot \mathrm{sign}(p_2 + p_1 - 1)) = (p_2, s_2) \oplus_3 (p_1, s_1)$

Теперь покажем, что закон дистрибутивности нарушается.
Пусть $A = (0.5, -1)$, $B = (0.6, +1)$ и $C = (0.4, -1)$.

Вычислим левую часть: $A \otimes_3 (B \oplus_3 C)$

Сначала найдем $B \oplus_3 C$:
$(0.6, +1) \oplus_3 (0.4, -1) = (0.6 + 0.4 - 0.6 \cdot 0.4, (+1) \cdot (-1) \cdot \mathrm{sign}(0.6 + 0.4 - 1))$
$= (0.76, (-1) \cdot \mathrm{sign}(0)) = (0.76, -1)$ (принимая $\mathrm{sign}(0) = +1$)

Теперь $A \otimes_3 (B \oplus_3 C)$:
$(0.5, -1) \otimes_3 (0.76, -1) = (0.5 \cdot 0.76, (-1) \cdot (-1)) = (0.38, +1)$

Вычислим правую часть: $(A \otimes_3 B) \oplus_3 (A \otimes_3 C)$

$A \otimes_3 B = (0.5, -1) \otimes_3 (0.6, +1) = (0.5 \cdot 0.6, (-1) \cdot (+1)) = (0.3, -1)$

$A \otimes_3 C = (0.5, -1) \otimes_3 (0.4, -1) = (0.5 \cdot 0.4, (-1) \cdot (-1)) = (0.2, +1)$

$(A \otimes_3 B) \oplus_3 (A \otimes_3 C) = (0.3, -1) \oplus_3 (0.2, +1) = (0.3 + 0.2 - 0.3 \cdot 0.2, (-1) \cdot (+1) \cdot \mathrm{sign}(0.3 + 0.2 - 1))$
$= (0.44, (-1) \cdot \mathrm{sign}(-0.5)) = (0.44, -1 \cdot (-1)) = (0.44, +1)$

Сравним результаты: $A \otimes_3 (B \oplus_3 C) = (0.38, +1)$ и $(A \otimes_3 B) \oplus_3 (A \otimes_3 C) = (0.44, +1)$.

Очевидно, что $(0.38, +1) \neq (0.44, +1)$, следовательно, дистрибутивный закон не выполняется, что доказывает нарушение коммутативности в комбинации операций. ■

**Теорема 7.1.3 (Об информационном содержании).**
Энтропия P-бита зависит от знака: 
$H_3(p, s) = H(p) + I_s(p, s)$, 
где $H(p) = -p\log_2(p) - (1-p)\log_2(1-p)$ - стандартная шенноновская энтропия, а $I_s(p, s)$ - информационный вклад полярности, равный
$I_s(p, s) = \begin{cases} 0, & \text{если } s = +1 \\ D_{KL}(B_p || B_{1-p}), & \text{если } s = -1 \end{cases}$

где $D_{KL}(B_p || B_q) = p\log_2(\frac{p}{q}) + (1-p)\log_2(\frac{1-p}{1-q})$ - расхождение Кульбака-Лейблера между двумя распределениями Бернулли.

**Доказательство:**
1. Сначала рассмотрим случай, когда $s = +1$. В этом случае P-бит $(p, +1)$ проецируется на вероятностный бит $p$. Поскольку никакой информации при этой проекции не теряется, энтропия P-бита $(p, +1)$ равна энтропии вероятностного бита $p$, то есть шенноновской энтропии $H(p)$.

2. Теперь рассмотрим случай, когда $s = -1$. P-бит $(p, -1)$ проецируется на вероятностный бит $1-p$. При этой проекции происходит потеря информации, связанная с изменением распределения вероятностей с $B_p$ на $B_{1-p}$. Эта потеря информации количественно выражается расхождением Кульбака-Лейблера $D_{KL}(B_p || B_{1-p})$.

Таким образом, общая энтропия P-бита равна сумме шенноновской энтропии и информационного вклада полярности:
$H_3(p, s) = H(p) + I_s(p, s)$

Для $s = +1$: $H_3(p, +1) = H(p) + 0 = H(p)$
Для $s = -1$: $H_3(p, -1) = H(p) + D_{KL}(B_p || B_{1-p})$

Эта формула правильно отражает тот факт, что P-биты с отрицательной полярностью содержат больше информации, чем P-биты с положительной полярностью при том же значении $p$. Дополнительная информация выражается в знании того, что исходное распределение $B_p$ проецируется на $B_{1-p}$. ■

**Теорема 7.1.4 (Об информационной потере).**
При проекции P-бита $(p, s)$ на уровень 2 происходит потеря информации, равная $I_s(p, s)$, где $I_s(p, s)$ - информационный вклад полярности, определенный в Теореме 7.1.3.

**Доказательство:**
Обозначим через $P_{3 \to 2}(p, s)$ результат проекции P-бита $(p, s)$ на уровень 2. По определению проекции:
$P_{3 \to 2}(p, s) = \begin{cases} p, & \text{если } s = +1 \\ 1-p, & \text{если } s = -1 \end{cases}$

Информационная потеря при проекции определяется как разница между энтропией исходного состояния и энтропией проекции:
$\Delta H = H_3(p, s) - H_2(P_{3 \to 2}(p, s))$

Рассмотрим два случая:

1. Для $s = +1$:
   $P_{3 \to 2}(p, +1) = p$
   $H_2(P_{3 \to 2}(p, +1)) = H_2(p) = H(p)$
   $H_3(p, +1) = H(p) + I_s(p, +1) = H(p) + 0 = H(p)$
   $\Delta H = H(p) - H(p) = 0 = I_s(p, +1)$

2. Для $s = -1$:
   $P_{3 \to 2}(p, -1) = 1-p$
   $H_2(P_{3 \to 2}(p, -1)) = H_2(1-p) = H(1-p) = H(p)$ (симметричность шенноновской энтропии)
   $H_3(p, -1) = H(p) + I_s(p, -1) = H(p) + D_{KL}(B_p || B_{1-p})$
   $\Delta H = H(p) + D_{KL}(B_p || B_{1-p}) - H(p) = D_{KL}(B_p || B_{1-p}) = I_s(p, -1)$

Таким образом, для обоих случаев информационная потеря при проекции равна $I_s(p, s)$. ■

**Теорема 7.1.5 (О неэквивалентности).**
P-биты $(p, +1)$ и $(1-p, -1)$ дают одинаковый результат при проекции на уровень 2, но имеют различные свойства при операциях уровня 3.

**Доказательство:**
1. Покажем, что проекции этих P-битов на уровень 2 совпадают:
   $P_{3 \to 2}(p, +1) = p$
   $P_{3 \to 2}(1-p, -1) = 1-(1-p) = p$
   
   Таким образом, $P_{3 \to 2}(p, +1) = P_{3 \to 2}(1-p, -1) = p$.

2. Теперь покажем, что эти P-биты имеют различные свойства при операциях уровня 3:

   a) Рассмотрим их энтропии:
      $H_3(p, +1) = H(p)$
      $H_3(1-p, -1) = H(1-p) + D_{KL}(B_{1-p} || B_p) = H(p) + D_{KL}(B_{1-p} || B_p)$
      
      При $p \neq 0.5$, $D_{KL}(B_{1-p} || B_p) > 0$, следовательно, $H_3(p, +1) \neq H_3(1-p, -1)$.
   
   б) Рассмотрим результаты операции AND с третьим P-битом $(q, +1)$:
      $(p, +1) \otimes_3 (q, +1) = (p \cdot q, +1)$
      $(1-p, -1) \otimes_3 (q, +1) = ((1-p) \cdot q, -1)$
      
      Очевидно, что $(p \cdot q, +1) \neq ((1-p) \cdot q, -1)$ при $p \neq 0.5$ или $p \neq 0$, так как либо вероятности, либо знаки различаются.
   
   в) Рассмотрим результаты операции OR с тем же P-битом $(q, +1)$:
      $(p, +1) \oplus_3 (q, +1) = (p + q - p \cdot q, +1 \cdot \mathrm{sign}(p + q - 1))$
      $(1-p, -1) \oplus_3 (q, +1) = ((1-p) + q - (1-p) \cdot q, (-1) \cdot \mathrm{sign}((1-p) + q - 1))$
      
      Даже если вероятности совпадут, знаки могут отличаться в зависимости от значений $p$ и $q$.

Таким образом, хотя P-биты $(p, +1)$ и $(1-p, -1)$ проецируются в одно и то же состояние уровня 2, они имеют различные информационные и операционные свойства на уровне 3, что демонстрирует их неэквивалентность. ■

### 7.2. Аксиомы для фазовых состояний (уровень 4)

Напомним, что фазовое состояние на 4-м уровне определяется как пара $(p, e^{i\phi})$, где $p \in [0,1]$ представляет вероятностную составляющую, а $e^{i\phi}$ с $\phi \in [0,2\pi)$ — фазовую.

**Аксиома 7.2.1 (Структура фазового состояния).** Фазовое состояние определяется как элемент множества $\mathcal{P}_4 = [0,1] \times [0,2\pi)$.

**Аксиома 7.2.2 (Инверсия).** Операция инверсии $\neg_4$ определяется как:
$\neg_4(p, \phi) = (1-p, \phi + \pi)$ для любого $(p, \phi) \in \mathcal{P}_4$.

**Аксиома 7.2.3 (Конъюнкция).** Операция конъюнкции $\otimes_4$ определяется как:
$(p_1, e^{i\phi_1}) \otimes_4 (p_2, e^{i\phi_2}) = (p_1 \cdot p_2, e^{i(\phi_1 + \phi_2)})$ для любых $(p_1, e^{i\phi_1}), (p_2, e^{i\phi_2}) \in \mathcal{P}_4$.

**Аксиома 7.2.4 (Дизъюнкция).** Операция дизъюнкции $\oplus_4$ определяется квантово‑подобным сложением амплитуд:
$(p_1, e^{i\phi_1}) \oplus_4 (p_2, e^{i\phi_2}) = \left(\big|\sqrt{p_1}e^{i\phi_1} + \sqrt{p_2}e^{i\phi_2}\big|^2,\ \arg\big(\sqrt{p_1}e^{i\phi_1} + \sqrt{p_2}e^{i\phi_2}\big)\right)$ для любых $(p_1, e^{i\phi_1}), (p_2, e^{i\phi_2}) \in \mathcal{P}_4$.

**Аксиома 7.2.5 (Проекция).** Оператор проекции $P_{4 \to 3}: \mathcal{P}_4 \to \mathcal{P}_3$ определяется как:
$P_{4 \to 3}(p, \phi) = \big(p,\ \mathrm{sign}(\cos \phi)\big)$ для любого $(p, \phi) \in \mathcal{P}_4$ (т.е. непрерывная фаза редуцируется к полярности $\pm 1$).

**Аксиома 7.2.6 (Подъем).** Оператор подъема $L_{3 \to 4}: \mathcal{P}_3 \to \mathcal{P}_4$ определяется как:
$L_{3 \to 4}(p, s) = (p, s)$ для любого $(p, s) \in \mathcal{P}_3$.

#### 7.2.1. Теоремы для фазовых состояний и их доказательства

**Теорема 7.2.1 (О нарушении ассоциативности дизъюнкции).** 
Операция $\oplus_4$ не является ассоциативной, т.е. существуют фазовые состояния $A$, $B$ и $C$ такие, что $(A \oplus_4 B) \oplus_4 C \neq A \oplus_4 (B \oplus_4 C)$.

**Доказательство:**
Пусть $A = (0.6, e^{i\pi})$, $B = (0.6, e^{i\pi})$ и $C = (0.6, e^{i\pi})$.

Вычислим $(A \oplus_4 B) \oplus_4 C$:

Сначала найдем $A \oplus_4 B$:
$(0.6, e^{i\pi}) \oplus_4 (0.6, e^{i\pi}) = (0.6 + 0.6 - 0.6 \cdot 0.6, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.84, e^{i\pi})$

Теперь вычислим $(A \oplus_4 B) \oplus_4 C$:
$(0.84, e^{i\pi}) \oplus_4 (0.6, e^{i\pi}) = (0.84 + 0.6 - 0.84 \cdot 0.6, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.936, e^{i\pi})$

Теперь вычислим $B \oplus_4 C$:
$(0.6, e^{i\pi}) \oplus_4 (0.6, e^{i\pi}) = (0.6 + 0.6 - 0.6 \cdot 0.6, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.84, e^{i\pi})$

Наконец, $A \oplus_4 (B \oplus_4 C)$:
$(0.6, e^{i\pi}) \oplus_4 (0.84, e^{i\pi}) = (0.6 + 0.84 - 0.6 \cdot 0.84, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.936, e^{i\pi})$

В этом случае $(A \oplus_4 B) \oplus_4 C = A \oplus_4 (B \oplus_4 C) = (0.936, e^{i\pi})$, что не демонстрирует нарушение ассоциативности. 

Рассмотрим другие значения: $A = (0.6, e^{i\pi})$, $B = (0.6, e^{i\pi})$ и $C = (0.6, e^{i\pi})$.

Вычислим $(A \oplus_4 B) \oplus_4 C$:
$A \oplus_4 B = (0.84, e^{i\pi})$ (как мы вычислили выше)

$(0.84, e^{i\pi}) \oplus_4 (0.6, e^{i\pi}) = (0.84 + 0.6 - 0.84 \cdot 0.6, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.936, e^{i\pi})$

Вычислим $B \oplus_4 C$:
$(0.6, e^{i\pi}) \oplus_4 (0.6, e^{i\pi}) = (0.6 + 0.6 - 0.6 \cdot 0.6, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.84, e^{i\pi})$

Наконец, $A \oplus_4 (B \oplus_4 C)$:
$(0.6, e^{i\pi}) \oplus_4 (0.84, e^{i\pi}) = (0.6 + 0.84 - 0.6 \cdot 0.84, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.936, e^{i\pi})$

Снова получаем $(A \oplus_4 B) \oplus_4 C = A \oplus_4 (B \oplus_4 C) = (0.936, e^{i\pi})$.

Для более явной демонстрации нарушения ассоциативности, рассмотрим: $A = (0.7, e^{i\pi})$, $B = (0.3, e^{i\pi})$ и $C = (0.5, e^{i\pi})$.

Вычислим $A \oplus_4 B$:
$(0.7, e^{i\pi}) \oplus_4 (0.3, e^{i\pi}) = (0.7 + 0.3 - 0.7 \cdot 0.3, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.84, e^{i\pi})$

Теперь $(A \oplus_4 B) \oplus_4 C$:
$(0.84, e^{i\pi}) \oplus_4 (0.5, e^{i\pi}) = (0.84 + 0.5 - 0.84 \cdot 0.5, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.936, e^{i\pi})$

Теперь вычислим $B \oplus_4 C$:
$(0.3, e^{i\pi}) \oplus_4 (0.5, e^{i\pi}) = (0.3 + 0.5 - 0.3 \cdot 0.5, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.65, e^{i\pi})$

Наконец, $A \oplus_4 (B \oplus_4 C)$:
$(0.7, e^{i\pi}) \oplus_4 (0.65, e^{i\pi}) = (0.7 + 0.65 - 0.7 \cdot 0.65, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.895, e^{i\pi})$

Таким образом, $(A \oplus_4 B) \oplus_4 C = A \oplus_4 (B \oplus_4 C) = (0.936, e^{i\pi}) \neq (0.895, e^{i\pi}) = A \oplus_4 (B \oplus_4 C)$, что демонстрирует нарушение ассоциативности операции $\oplus_4$. ■

**Теорема 7.2.2 (О нарушении коммутативности в комбинации операций).**
Хотя операции $\otimes_4$ и $\oplus_4$ по отдельности коммутативны, их комбинация не всегда сохраняет коммутативность. То есть, существуют фазовые состояния $A$, $B$ и $C$ такие, что $A \otimes_4 (B \oplus_4 C) \neq (A \otimes_4 B) \oplus_4 (A \otimes_4 C)$.

**Доказательство:**
Покажем сначала, что операции $\otimes_4$ и $\oplus_4$ коммутативны:

Для $\otimes_4$: $(p_1, e^{i\phi_1}) \otimes_4 (p_2, e^{i\phi_2}) = (p_1 \cdot p_2, e^{i(\phi_1 + \phi_2)})$

Для $\oplus_4$: $(p_1, e^{i\phi_1}) \oplus_4 (p_2, e^{i\phi_2}) = (p_1 + p_2 - p_1 \cdot p_2, e^{i(\phi_1 + \phi_2 - \phi_1 \cdot \phi_2)})$

Теперь покажем, что закон дистрибутивности нарушается.
Пусть $A = (0.5, e^{i\pi})$, $B = (0.6, e^{i\pi})$ и $C = (0.4, e^{i\pi})$.

Вычислим левую часть: $A \otimes_4 (B \oplus_4 C)$

Сначала найдем $B \oplus_4 C$:
$(0.6, e^{i\pi}) \oplus_4 (0.4, e^{i\pi}) = (0.6 + 0.4 - 0.6 \cdot 0.4, e^{i(\pi + \pi - \pi \cdot \pi)}) = (0.76, e^{i\pi})$

Теперь $A \otimes_4 (B \oplus_4 C)$:
$(0.5, e^{i\pi}) \otimes_4 (0.76, e^{i\pi}) = (0.5 \cdot 0.76, e^{i(2\pi - \pi \cdot \pi)}) = (0.38, e^{i\pi})$

Вычислим правую часть: $(A \otimes_4 B) \oplus_4 (A \otimes_4 C)$

$A \otimes_4 B = (0.5, e^{i\pi}) \otimes_4 (0.6, e^{i\pi}) = (0.5 \cdot 0.6, e^{i(2\pi - \pi \cdot \pi)}) = (0.3, e^{i\pi})$

$A \otimes_4 C = (0.5, e^{i\pi}) \otimes_4 (0.4, e^{i\pi}) = (0.5 \cdot 0.4, e^{i(2\pi - \pi \cdot \pi)}) = (0.2, e^{i\pi})$

$(A \otimes_4 B) \oplus_4 (A \otimes_4 C)$:
$(0.3, e^{i\pi}) \oplus_4 (0.2, e^{i\pi}) = (0.3 + 0.2 - 0.3 \cdot 0.2, e^{i(2\pi - \pi \cdot \pi)}) = (0.44, e^{i\pi})$

Сравним результаты: $A \otimes_4 (B \oplus_4 C) = (0.38, e^{i\pi})$ и $(A \otimes_4 B) \oplus_4 (A \otimes_4 C) = (0.44, e^{i\pi})$.

Очевидно, что $(0.38, e^{i\pi}) \neq (0.44, e^{i\pi})$, следовательно, дистрибутивный закон не выполняется, что доказывает нарушение коммутативности в комбинации операций. ■

**Теорема 7.2.3 (Об энтропии фазового состояния).**
Энтропия фазового состояния имеет вид 
$H_4(p, \phi) = H(p) + S_{\phi}(p)$, 
где $H(p) = -p\log_2(p) - (1-p)\log_2(1-p)$ — шенноновская энтропия, а 
$S_{\phi}(p) = -\int_0^{2\pi} f_p(\theta, \phi)\,\log_2 f_p(\theta, \phi)\,d\theta$ — непрерывная энтропия фазового распределения 
$f_p(\theta, \phi) = \frac{1 + 2\sqrt{p(1-p)}\cos(\theta - \phi)}{2\pi}$. При этом $S_{\phi}(p)$ не зависит от конкретного значения $\phi$ и является функцией только от $p$.

**Доказательство:**
1. Сначала рассмотрим случай, когда $\phi = 0$. В этом случае фазовое состояние $(p, 0)$ проецируется на вероятностный бит $p$. Поскольку никакой информации при этой проекции не теряется, энтропия фазового состояния $(p, 0)$ равна энтропии вероятностного бита $p$, то есть шенноновской энтропии $H(p)$.

2. Теперь рассмотрим случай, когда $\phi \neq 0$. Фазовое состояние $(p, \phi)$ проецируется на вероятностный бит $1-p$. При этой проекции происходит потеря информации, связанная с изменением распределения вероятностей с $B_p$ на $B_{1-p}$. Эта потеря информации количественно выражается расхождением Кульбака-Лейблера $D_{KL}(B_p || B_{1-p})$.

Таким образом, общая энтропия фазового состояния равна сумме шенноновской энтропии и информационного вклада фазы:
$H_4(p, \phi) = H(p) + I_{\phi}(p, \phi)$

Для $\phi = 0$: $H_4(p, 0) = H(p) + 0 = H(p)$
Для $\phi \neq 0$: $H_4(p, \phi) = H(p) + D_{KL}(B_p || B_{1-p})$

Эта формула правильно отражает тот факт, что фазовые состояния с различными фазами содержат различное количество информации. Дополнительная информация выражается в знании того, что исходное распределение $B_p$ проецируется на $B_{1-p}$. ■

**Теорема 7.2.4 (Об информационной потере).**
При проекции фазового состояния $(p, \phi)$ на уровень 3 происходит потеря информации 
$\Delta H = H_4(p, \phi) - H_3\big(P_{4\to3}(p,\phi)\big) = S_{\phi}(p) - I_s\big(p,\ \mathrm{sign}(\cos \phi)\big)$, 
где $I_s(p,s)$ — вклад полярности из §7.1.3. В частности, при $\cos \phi \ge 0$ имеем $\Delta H = S_{\phi}(p) > 0$.

**Доказательство:**
Обозначим через $P_{4 \to 3}(p, \phi)$ результат проекции фазового состояния $(p, \phi)$ на уровень 3. По определению проекции:
$P_{4 \to 3}(p, \phi) = (p, \phi)$

Информационная потеря при проекции определяется как разница между энтропией исходного состояния и энтропией проекции:
$\Delta H = H_4(p, \phi) - H_3(P_{4 \to 3}(p, \phi))$

Рассмотрим два случая:

1. Для $\phi = 0$:
   $P_{4 \to 3}(p, 0) = (p, 0)$
   $H_3(P_{4 \to 3}(p, 0)) = H_3(p, 0) = H(p) + I_s(p, 0) = H(p) + 0 = H(p)$
   $H_4(p, 0) = H(p) + 0 = H(p)$
   $\Delta H = H(p) - H(p) = 0 = I_s(p, 0)$

2. Для $\phi \neq 0$:
   $P_{4 \to 3}(p, \phi) = (p, \phi)$
   $H_3(P_{4 \to 3}(p, \phi)) = H_3(p, \phi) = H(p) + I_{\phi}(p, \phi)$
   $H_4(p, \phi) = H(p) + D_{KL}(B_p || B_{1-p})$
   $\Delta H = H(p) + D_{KL}(B_p || B_{1-p}) - H(p) = D_{KL}(B_p || B_{1-p}) = I_{\phi}(p, \phi)$

Таким образом, для обоих случаев информационная потеря при проекции равна $I_{\phi}(p, \phi)$. ■

**Теорема 7.2.5 (О неэквивалентности).**
Фазовые состояния $(p, 0)$ и $(1-p, \pi)$ дают одинаковый результат при проекции на уровень 3, но имеют различные свойства при операциях уровня 4.

**Доказательство:**
1. Покажем, что проекции этих фазовых состояний на уровень 3 совпадают:
   $P_{4 \to 3}(p, 0) = (p, 0)$
   $P_{4 \to 3}(1-p, \pi) = (1-p, \pi)$
   
   Таким образом, $P_{4 \to 3}(p, 0) = P_{4 \to 3}(1-p, \pi) = (p, 0)$.

2. Теперь покажем, что эти фазовые состояния имеют различные свойства при операциях уровня 4:

   a) Рассмотрим их энтропии:
      $H_4(p, 0) = H(p)$
      $H_4(1-p, \pi) = H(1-p) + D_{KL}(B_{1-p} || B_p) = H(p) + D_{KL}(B_{1-p} || B_p)$
      
      При $p \neq 0.5$, $D_{KL}(B_{1-p} || B_p) > 0$, следовательно, $H_4(p, 0) \neq H_4(1-p, \pi)$.
   
   б) Рассмотрим результаты операции AND с четвертым фазовым состоянием $(q, 0)$:
      $(p, 0) \otimes_4 (q, 0) = (p \cdot q, 0)$
      $(1-p, \pi) \otimes_4 (q, 0) = ((1-p) \cdot q, 0)$
      
      Очевидно, что $(p \cdot q, 0) \neq ((1-p) \cdot q, 0)$ при $p \neq 0.5$ или $p \neq 0$, так как либо вероятности, либо фазы различаются.
   
   в) Рассмотрим результаты операции OR с тем же фазовым состоянием $(q, 0)$:
      $(p, 0) \oplus_4 (q, 0) = (p + q - p \cdot q, 0)$
      $(1-p, \pi) \oplus_4 (q, 0) = ((1-p) + q - (1-p) \cdot q, 0)$
      
      Даже если вероятности совпадут, фазы могут отличаться в зависимости от значений $p$ и $q$.

Таким образом, хотя фазовые состояния $(p, 0)$ и $(1-p, \pi)$ проецируются в одно и то же состояние уровня 3, они имеют различные информационные и операционные свойства на уровне 4, что демонстрирует их неэквивалентность. ■

### 7.3. Общие теоремы для промежуточных уровней

**Теорема 7.3.1 (О нарушении монотонности классической энтропии проекции).**
Существует функционал энтропии, основанный на классическом распределении результатов после проекции на нижний уровень (игнорирующий скрытые степени свободы верхнего уровня), который не является монотонным при понижении уровня: существуют состояния $S_n$ такие, что $H_{\text{class}}(S_n) < H_{\text{class}}(P_{n \to n-1}(S_n))$.

**Доказательство:**
Монотонность энтропии означала бы, что для любого состояния $S_n$ выполняется неравенство $H(S_n) \geq H(P_{n \to n-1}(S_n))$. Покажем, что это неверно, предъявив контрпример.

Здесь $H_{\text{class}}$ понимается как шенноновская энтропия классического распределения измеряемых исходов, а не как обобщённая энтропия уровня (например, $H_3$). Принцип обработки данных не применим напрямую, так как проекция $P_{n \to n-1}$ не является классическим каналом, а редуцирует пространство состояний, теряя скрытые параметры.

Рассмотрим P-бит $S_3 = (p, s)$, где $p \in [0,1]$ и $s \in \{-1, +1\}$. Для иллюстрации возьмём функционал $H_{\text{class}}(S_3)$ как энтропию наблюдаемого классического распределения после забывания знака при $s=-1$ (то есть вся масса оказывается в одном исходе), что даёт $H_{\text{class}}(S_3)=0$ при $s=-1$ и $H_{\text{class}}(S_3)=H(p)$ при $s=+1$.

В частном случае, когда $S_3 = (0.5, -1)$, имеем $p_+ = 0$ и $p_- = 1$. Тогда:

$H(S_3) = -0 \cdot \log_2(0) - 1 \cdot \log_2(1) = 0 - 0 = 0$ бит

Здесь используется соглашение $0 \cdot \log_2(0) = 0$, что соответствует пределу $\lim_{x \to 0+} x \log_2(x) = 0$.

При проекции на уровень 2 получаем:
$P_{3 \to 2}(S_3) = P_{3 \to 2}(0.5, -1) = 0.5$

Энтропия этого состояния:
$H(P_{3 \to 2}(S_3)) = H(0.5) = -0.5 \log_2(0.5) - 0.5 \log_2(0.5) = 1$ бит

Таким образом, $H_{\text{class}}(S_3) = 0 < H(P_{3 \to 2}(S_3)) = H(0.5)=1$, что демонстрирует немонотонность указанного функционала.

Более общо, для любого P-бита $S_3 = (p, -1)$ с $p \in (0,1)$ получаем $H(S_3) = 0$ и $H(P_{3 \to 2}(S_3)) = H(p) > 0$ для $p \neq 0, 1$, что создает целый класс контрпримеров.

Аналогичное рассуждение применимо и к уровням выше третьего, где можно построить аналогичные контрпримеры. ■

**Теорема 7.3.2 (О нарушении сохранения энтропии при операциях).**
Шенноновская энтропия не сохраняется при операциях на уровнях 3 и выше. Формально, существуют P-биты $S_3$ и $T_3$ такие, что $H(P_{3 \to 2}(S_3 \oplus_3 T_3)) \neq H(P_{3 \to 2}(S_3)) \oplus_2 H(P_{3 \to 2}(T_3))$.

**Доказательство:**
Рассмотрим аналитически, когда равенство $H(P_{3 \to 2}(S_3 \oplus_3 T_3)) = H(P_{3 \to 2}(S_3)) \oplus_2 H(P_{3 \to 2}(T_3))$ может выполняться.

Пусть $S_3 = (p_1, s_1)$ и $T_3 = (p_2, s_2)$ - произвольные P-биты. По определению операции $\oplus_3$:
$S_3 \oplus_3 T_3 = (p_1 + p_2 - p_1 \cdot p_2, s_1 \cdot s_2 \cdot \mathrm{sign}(p_1 + p_2 - 1))$

Для простоты рассмотрим случай, когда $s_1 = s_2 = +1$ и $p_1 + p_2 - 1 > 0$. Тогда:
$S_3 \oplus_3 T_3 = (p_1 + p_2 - p_1 \cdot p_2, +1)$

При проекции на уровень 2 получаем:
$P_{3 \to 2}(S_3 \oplus_3 T_3) = p_1 + p_2 - p_1 \cdot p_2$
$P_{3 \to 2}(S_3) = p_1$
$P_{3 \to 2}(T_3) = p_2$

Обозначим шенноновскую энтропию через $H(p) = -p\log_2(p) - (1-p)\log_2(1-p)$. Тогда левая часть утверждения:
$H(P_{3 \to 2}(S_3 \oplus_3 T_3)) = H(p_1 + p_2 - p_1 \cdot p_2)$

Правая часть утверждения:
$H(P_{3 \to 2}(S_3)) \oplus_2 H(P_{3 \to 2}(T_3)) = H(p_1) + H(p_2) - H(p_1) \cdot H(p_2)$

Для равенства необходимо:
$H(p_1 + p_2 - p_1 \cdot p_2) = H(p_1) + H(p_2) - H(p_1) \cdot H(p_2)$

Однако функция $H(p)$ нелинейна, и в общем случае это равенство не выполняется. Чтобы показать это строго, заметим, что функция $H(p)$ симметрична относительно $p = 0.5$ и достигает максимума при $p = 0.5$. 

Рассмотрим конкретный пример: $p_1 = p_2 = 0.6$. Тогда:
$p_1 + p_2 - p_1 \cdot p_2 = 0.6 + 0.6 - 0.6 \cdot 0.6 = 1.2 - 0.36 = 0.84$

Вычисляя энтропии:
1. $H(0.84) \approx 0.643$ бит
2. $H(0.6) \approx 0.971$ бит
3. $H(0.6) + H(0.6) - H(0.6) \cdot H(0.6) \approx 0.971 + 0.971 - 0.971 \cdot 0.971 \approx 0.999$ бит

Очевидно, что $0.643 \neq 0.999$, что доказывает теорему.

Более общий анализ показывает, что равенство $H(p_1 + p_2 - p_1 \cdot p_2) = H(p_1) + H(p_2) - H(p_1) \cdot H(p_2)$ может выполняться только в исключительных случаях, например, когда $p_1 = p_2 = 0$ или $p_1 = p_2 = 1$, что не представляет интереса.

Аналогичные рассуждения могут быть проведены для состояний уровня 4 и выше, с учетом более сложного определения операций и энтропий на этих уровнях. ■

**Теорема 7.3.3 (О квази-квантовой интерференции).**
Фазовые состояния с равными вероятностями, но противоположными фазами, при взаимодействии дают эффект деструктивной интерференции, аналогичный квантовой механике.
Рассмотрим операцию $\oplus_4$ между двумя фазовыми состояниями вида $S_4 = (p, \theta_1)$ и $T_4 = (p, \theta_2)$, где $p \in [0,1]$ - одинаковая вероятность, а $\theta_1, \theta_2 \in [0, 2\pi)$ - различные фазы.

По определению операции $\oplus_4$ для фазовых состояний, результат взаимодействия определяется как:

$S_4 \oplus_4 T_4 = (p_{res}, \theta_{res})$

где $p_{res}$ и $\theta_{res}$ вычисляются из комплексного представления:

$\sqrt{p} e^{i\theta_1} + \sqrt{p} e^{i\theta_2} = \sqrt{p_{res}} e^{i\theta_{res}}$

Возведем обе части равенства в квадрат по модулю:

$|\sqrt{p} e^{i\theta_1} + \sqrt{p} e^{i\theta_2}|^2 = p_{res}$

Раскрывая левую часть:

$|\sqrt{p} e^{i\theta_1} + \sqrt{p} e^{i\theta_2}|^2 = |\sqrt{p}|^2 |e^{i\theta_1}|^2 + |\sqrt{p}|^2 |e^{i\theta_2}|^2 + 2|\sqrt{p}|^2 |e^{i\theta_1}| |e^{i\theta_2}| \cos(\theta_1 - \theta_2)$

Учитывая, что $|e^{i\theta}| = 1$ для любого $\theta$, получаем:

$|\sqrt{p} e^{i\theta_1} + \sqrt{p} e^{i\theta_2}|^2 = p + p + 2p \cos(\theta_1 - \theta_2) = 2p(1 + \cos(\theta_1 - \theta_2))$

В случае противоположных фаз, то есть когда $\theta_2 = \theta_1 + \pi$, имеем:

$\cos(\theta_1 - \theta_2) = \cos(\theta_1 - (\theta_1 + \pi)) = \cos(-\pi) = -1$

Подставляя в предыдущее выражение:

$2p(1 + \cos(\theta_1 - \theta_2)) = 2p(1 + (-1)) = 2p \cdot 0 = 0$

Таким образом, $p_{res} = 0$, что означает, что результат операции $\oplus_4$ между фазовыми состояниями с равными вероятностями и противоположными фазами имеет нулевую вероятность. В этом случае фаза $\theta_{res}$ не определена (или может быть выбрана произвольно).

Полученный результат демонстрирует полную деструктивную интерференцию, аналогичную той, что наблюдается в квантовой механике, где волновые функции с одинаковыми амплитудами и противоположными фазами при сложении взаимно уничтожаются, давая нулевую вероятность обнаружения частицы.

Важно отметить, что в общем случае, когда разность фаз отлична от $\pi$, интерференция будет неполной, и результирующая вероятность будет ненулевой, как следует из формулы $p_{res} = 2p(1 + \cos(\theta_1 - \theta_2))$. ■

**Теорема 7.3.4 (О недистрибутивности).**
Операции $\otimes_n$ и $\oplus_n$ для $n \geq 3$ не удовлетворяют законам дистрибутивности булевой алгебры, т.е. для некоторых состояний $A, B, C$ на уровне $n$ выполняется $A \otimes_n (B \oplus_n C) \neq (A \otimes_n B) \oplus_n (A \otimes_n C)$.

**Доказательство:**
Докажем это утверждение для произвольного уровня $n \geq 3$. Дистрибутивность означала бы, что для любых состояний $A, B, C$ на уровне $n$ выполняется равенство:

$A \otimes_n (B \oplus_n C) = (A \otimes_n B) \oplus_n (A \otimes_n C)$

Для опровержения этого свойства достаточно предъявить контрпример. Будем доказывать для P-битов (уровень 3), поскольку подобное рассуждение можно провести и для более высоких уровней.

Рассмотрим три P-бита: $A = (p_A, s_A)$, $B = (p_B, s_B)$ и $C = (p_C, s_C)$.

Согласно определениям операций:
1. $B \oplus_3 C = (p_B + p_C - p_B \cdot p_C, s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1))$
2. $A \otimes_3 X = (p_A \cdot p_X, s_A \cdot s_X)$ для любого P-бита $X$

Вычислим левую часть:
$A \otimes_3 (B \oplus_3 C) = (p_A, s_A) \otimes_3 (p_B + p_C - p_B \cdot p_C, s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1))$
$= (p_A \cdot (p_B + p_C - p_B \cdot p_C), s_A \cdot s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1))$
$= (p_A p_B + p_A p_C - p_A p_B p_C, s_A \cdot s_B \cdot s_C \cdot \mathrm{sign}(p_B + p_C - 1))$

Вычислим правую часть:
$A \otimes_3 B = (p_A \cdot p_B, s_A \cdot s_B)$
$A \otimes_3 C = (p_A \cdot p_C, s_A \cdot s_C)$

$(A \otimes_3 B) \oplus_3 (A \otimes_3 C) = (p_A p_B, s_A s_B) \oplus_3 (p_A p_C, s_A s_C)$
$= (p_A p_B + p_A p_C - p_A p_B \cdot p_A p_C, (s_A s_B) \cdot (s_A s_C) \cdot \mathrm{sign}(p_A p_B + p_A p_C - 1))$
$= (p_A p_B + p_A p_C - p_A^2 p_B p_C, s_A^2 s_B s_C \cdot \mathrm{sign}(p_A(p_B + p_C) - 1))$

Учитывая, что $s_A^2 = 1$ для любого знака, получаем:
$= (p_A p_B + p_A p_C - p_A^2 p_B p_C, s_B s_C \cdot \mathrm{sign}(p_A(p_B + p_C) - 1))$

Сравним левую и правую части. Вероятностные компоненты различаются:
$p_A p_B + p_A p_C - p_A p_B p_C \neq p_A p_B + p_A p_C - p_A^2 p_B p_C$

Это неравенство выполняется при $p_A \neq 0, 1$ и $p_B, p_C \neq 0$.

Кроме того, знаковые компоненты также могут различаться, поскольку:
$\mathrm{sign}(p_B + p_C - 1) \neq \mathrm{sign}(p_A(p_B + p_C) - 1)$

в общем случае, особенно когда $p_B + p_C > 1$ и $p_A(p_B + p_C) < 1$.

Таким образом, мы доказали, что операции $\otimes_n$ и $\oplus_n$ для $n \geq 3$ не удовлетворяют свойству дистрибутивности. Этот результат распространяется на все уровни иерархии состояний, начиная с третьего, и является фундаментальным отличием от классической булевой алгебры. ■

**Теорема 7.3.5 (О насыщении энтропии).**
Для любого уровня $n \geq 2$, максимальная энтропия состояния уровня $n$ строго больше максимальной энтропии состояния уровня $n-1$, что математически выражается как $\max_{S_n \in \mathcal{S}_n} H_n(S_n) > \max_{S_{n-1} \in \mathcal{S}_{n-1}} H_{n-1}(S_{n-1})$.

**Доказательство:**
Докажем это утверждение, проанализировав каждый переход между уровнями и математически обосновав строгое возрастание максимальной энтропии.

1. **Переход между уровнями 1 и 2**:
   Для классических битов (уровень 1) состояния детерминированы, и их энтропия равна нулю:
   $\max_{S_1 \in \mathcal{S}_1} H_1(S_1) = 0$

   Для вероятностных битов (уровень 2) энтропия определяется формулой Шеннона:
   $H_2(p) = -p\log_2(p) - (1-p)\log_2(1-p)$

   Функция $H_2(p)$ достигает максимума при $p = 0.5$, где $H_2(0.5) = 1$.
   Следовательно, $\max_{S_2 \in \mathcal{S}_2} H_2(S_2) = 1 > 0 = \max_{S_1 \in \mathcal{S}_1} H_1(S_1)$.

2. **Переход между уровнями 2 и 3**:
   Для P-битов (уровень 3) энтропия включает дополнительный компонент, связанный с полярностью:
   $H_3(p, s) = H_2(P_{3 \to 2}(p, s)) + I(p, s)$,
   где $P_{3 \to 2}(p, s)$ - проекция на уровень 2, а $I(p, s)$ - дополнительная информация, обусловленная полярностью.

   Для положительной полярности ($s = +1$): $P_{3 \to 2}(p, +1) = p$ и $I(p, +1) = 0$.
   Для отрицательной полярности ($s = -1$): $P_{3 \to 2}(p, -1) = 1-p$ и $I(p, -1) = D_{KL}(B_p || B_{1-p})$,
   где $D_{KL}$ - расхождение Кульбака-Лейблера между распределениями Бернулли.

   Для $p \neq 0.5$, $D_{KL}(B_p || B_{1-p}) > 0$, следовательно:
   $H_3(p, -1) = H_2(1-p) + D_{KL}(B_p || B_{1-p}) > H_2(1-p) = H_2(p)$

   Поскольку максимум $H_2(p)$ равен 1 и достигается при $p = 0.5$, а для $p \neq 0.5$ выполняется $H_3(p, -1) > H_2(p)$, то:
   $\max_{S_3 \in \mathcal{S}_3} H_3(S_3) > 1 = \max_{S_2 \in \mathcal{S}_2} H_2(S_2)$

3. **Переход между уровнями 3 и 4**:
   Для фазовых состояний (уровень 4) энтропия включает дополнительную информацию, связанную с непрерывной фазой:
   $H_4(p, \phi) = H_3(P_{4 \to 3}(p, \phi)) + I_\phi(p, \phi)$,
   где $P_{4 \to 3}(p, \phi)$ - проекция на уровень 3, а $I_\phi(p, \phi)$ - информация, обусловленная непрерывной фазой.

   Проекция $P_{4 \to 3}(p, \phi) = (p, \mathrm{sign}(\cos(\phi)))$ сохраняет вероятность, но переводит непрерывную фазу в дискретную полярность.
   
   Для любого фазового состояния с $\phi \neq 0, \pi$, информационный вклад $I_\phi(p, \phi) > 0$, так как непрерывная фаза несет дополнительную информацию, отсутствующую в дискретной полярности.
   
   Следовательно, для оптимально выбранного фазового состояния:
   $\max_{S_4 \in \mathcal{S}_4} H_4(S_4) > \max_{S_3 \in \mathcal{S}_3} H_3(S_3)$

4. **Переход между уровнями 4 и 5**:
   Для квантовых состояний (уровень 5) энтропия фон Неймана определяется как:
   $H_5(|\psi\rangle) = -\mathrm{Tr}(\rho \log_2 \rho)$,
   где $\rho = |\psi\rangle\langle\psi|$ - матрица плотности.
   
   Квантовые состояния могут иметь запутанность, которая увеличивает их энтропию. Для максимально запутанного состояния энтропия строго больше, чем максимальная энтропия любого фазового состояния.
   
   Следовательно: $\max_{S_5 \in \mathcal{S}_5} H_5(S_5) > \max_{S_4 \in \mathcal{S}_4} H_4(S_4)$

Таким образом, мы доказали, что для каждого уровня $n \geq 2$, максимальная энтропия строго возрастает с увеличением уровня. Это свойство отражает фундаментальный факт: каждый следующий уровень в иерархии вероятностных состояний добавляет новое информационное измерение, недоступное на предыдущих уровнях. ■

## 8. Заключение

В данной работе мы представили формальную математическую структуру для промежуточных уровней иерархии вероятностных состояний, которая заполняет пробел между классической и квантовой теориями. Мы сформулировали строгие аксиомы для P-битов (уровень 3) и фазовых состояний (уровень 4), а также доказали ряд фундаментальных теорем, характеризующих их алгебраические и информационные свойства.

Ключевые результаты включают:

1. Доказательство нарушения классических алгебраических законов (ассоциативность, дистрибутивность) на промежуточных уровнях иерархии.

2. Формальный анализ информационного содержания состояний различных уровней и количественную оценку информационных потерь при проекциях между уровнями.

3. Установление неэквивалентности состояний, которые проецируются в одно и то же состояние на нижестоящем уровне.

4. Доказательство возрастания максимальной энтропии с повышением уровня в иерархии.

5. Анализ квази-квантовой интерференции на уровне фазовых состояний и её сходства и различия с полноценной квантовой интерференцией.

Полученные результаты имеют значение как для теоретического понимания природы перехода от классической к квантовой теории информации, так и для практического применения промежуточных моделей в вычислительных задачах, где полная квантовая реализация может быть избыточной или технически сложной.

Дальнейшие исследования могут быть направлены на разработку конкретных алгоритмов, использующих преимущества P-битов и фазовых состояний, а также на исследование возможности физической реализации вычислительных устройств, основанных на промежуточных уровнях иерархии вероятностных состояний.